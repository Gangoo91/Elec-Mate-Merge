<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Minor Electrical Installation Works Certificate</title>
<style>
  /* ===== PAGE SETUP ===== */
  @page { size: A4; margin: 8mm 10mm 10mm 10mm; }
  *{ box-sizing:border-box; -webkit-print-color-adjust:exact; print-color-adjust:exact; }

  :root{
    --ink:#111827;
    --muted:#6b7280;
    --grid:#d1d5db;
    --grid-dark:#9ca3af;
    --shade:#f3f4f6;
    --shade-alt:#f9fafb;
    --accent:#1e40af;
    --accent-light:#dbeafe;
    --success:#059669;
    --warning:#d97706;

    --fs:10px;
    --fs-s:9px;
    --fs-xs:8px;
    --fs-lg:11px;
    --fs-title:15px;
    --lh:1.4;

    --pad:6px;
    --pad-sm:4px;
    --gap:4px;
    --radius:3px;
  }

  body{
    color:var(--ink);
    font-family:'Segoe UI', -apple-system, Arial, sans-serif;
    font-size:var(--fs);
    line-height:var(--lh);
    margin:0;
    padding:0;
  }

  /* ===== HEADER ===== */
  .header{
    display:grid;
    grid-template-columns:1fr auto;
    gap:12px;
    margin-bottom:8px;
    padding-bottom:6px;
    border-bottom:2px solid var(--accent);
  }

  .brand{
    display:flex;
    align-items:center;
    gap:10px;
  }

  .brand img{
    width:50px;
    height:50px;
    object-fit:contain;
    border:1px solid var(--grid);
    border-radius:var(--radius);
    padding:2px;
    background:white;
  }

  .brand-text .company{
    font-weight:700;
    font-size:12px;
    color:var(--accent);
  }

  .brand-text .contact{
    font-size:var(--fs-xs);
    color:var(--muted);
    line-height:1.3;
  }

  .title-block{
    margin-top:4px;
  }

  .title{
    font-size:var(--fs-title);
    font-weight:700;
    color:var(--ink);
    letter-spacing:-0.3px;
  }

  .subtitle{
    font-size:var(--fs-xs);
    color:var(--muted);
    margin-top:2px;
  }

  .cert-box{
    text-align:right;
    padding:8px 10px;
    background:var(--shade);
    border:1px solid var(--grid);
    border-radius:var(--radius);
    min-width:130px;
  }

  .cert-box .label{
    font-size:var(--fs-xs);
    color:var(--muted);
    margin-bottom:2px;
  }

  .cert-box .value{
    font-size:12px;
    font-weight:700;
    color:var(--ink);
    font-family:'Courier New', monospace;
  }

  /* ===== SECTION STYLING ===== */
  .section{
    margin-top:8px;
    break-inside:avoid;
    page-break-inside:avoid;
  }

  .section-bar{
    background:var(--accent);
    color:white;
    font-weight:600;
    font-size:var(--fs-s);
    padding:5px 8px;
    border-radius:var(--radius) var(--radius) 0 0;
    letter-spacing:0.2px;
  }

  .section-content{
    border:1px solid var(--grid);
    border-top:none;
    border-radius:0 0 var(--radius) var(--radius);
    padding:8px;
    background:white;
  }

  /* ===== TABLES ===== */
  .tbl{
    width:100%;
    border-collapse:collapse;
    font-size:var(--fs);
  }

  .tbl th, .tbl td{
    border:1px solid var(--grid);
    padding:var(--pad);
    vertical-align:top;
    text-align:left;
  }

  .tbl th{
    background:var(--shade);
    font-weight:600;
    font-size:var(--fs-s);
  }

  .tbl td{
    background:white;
  }

  .tbl .center{ text-align:center; }
  .tbl .right{ text-align:right; }

  /* ===== FORM ROWS ===== */
  .form-row{
    display:grid;
    grid-template-columns:repeat(12, 1fr);
    gap:var(--gap);
    margin-bottom:var(--gap);
  }

  .form-row:last-child{ margin-bottom:0; }

  .col-12{ grid-column:span 12; }
  .col-9{ grid-column:span 9; }
  .col-8{ grid-column:span 8; }
  .col-6{ grid-column:span 6; }
  .col-5{ grid-column:span 5; }
  .col-4{ grid-column:span 4; }
  .col-3{ grid-column:span 3; }
  .col-2{ grid-column:span 2; }

  .field-group{
    display:flex;
    flex-direction:column;
    gap:2px;
  }

  .field-label{
    font-size:var(--fs-xs);
    color:var(--muted);
    font-weight:500;
  }

  .field-value{
    font-size:var(--fs);
    color:var(--ink);
    padding:3px 5px;
    background:var(--shade-alt);
    border:1px solid var(--grid);
    border-radius:2px;
    min-height:20px;
    word-break:break-word;
  }

  .field-value.large{
    min-height:40px;
  }

  .field-value.xl{
    min-height:60px;
  }

  /* ===== CHECKBOXES ===== */
  .cb-group{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
  }

  .cb-item{
    display:inline-flex;
    align-items:center;
    gap:4px;
    font-size:var(--fs-s);
  }

  .cb{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    width:14px;
    height:14px;
    border:1px solid var(--grid-dark);
    border-radius:2px;
    background:white;
    font-size:10px;
    font-weight:bold;
    color:var(--success);
  }

  .cb.checked{
    background:var(--success);
    color:white;
    border-color:var(--success);
  }

  /* ===== INLINE FIELDS ===== */
  .inline-row{
    display:flex;
    flex-wrap:wrap;
    gap:4px 12px;
    font-size:var(--fs-s);
    line-height:1.6;
  }

  .inline-field{
    display:inline-flex;
    align-items:baseline;
    gap:4px;
  }

  .inline-label{
    color:var(--muted);
  }

  .inline-value{
    font-weight:500;
    color:var(--ink);
    padding:1px 4px;
    background:var(--shade-alt);
    border-bottom:1px solid var(--grid);
    min-width:40px;
  }

  .inline-value.wide{ min-width:80px; }
  .inline-value.wider{ min-width:120px; }

  /* ===== SIGNATURE ===== */
  .signature-area{
    display:grid;
    grid-template-columns:1fr 180px;
    gap:12px;
    margin-top:8px;
  }

  .signature-box{
    height:45px;
    border:1px dashed var(--grid-dark);
    border-radius:var(--radius);
    display:flex;
    align-items:center;
    justify-content:center;
    background:var(--shade-alt);
  }

  .signature-box img{
    max-height:40px;
    max-width:100%;
  }

  /* ===== DECLARATION BOX ===== */
  .declaration{
    background:var(--accent-light);
    border:1px solid var(--accent);
    border-radius:var(--radius);
    padding:8px;
    font-size:var(--fs-s);
    line-height:1.5;
    margin-bottom:8px;
  }

  .declaration strong{
    color:var(--accent);
  }

  /* ===== GUIDANCE ===== */
  .guidance{
    background:#fef9c3;
    border:1px solid #facc15;
    border-radius:var(--radius);
    padding:8px;
    margin-top:10px;
    font-size:var(--fs-xs);
    break-inside:avoid;
  }

  .guidance-title{
    font-weight:600;
    margin-bottom:4px;
    color:#854d0e;
  }

  .guidance ul{
    margin:0;
    padding-left:16px;
  }

  .guidance li{
    margin-bottom:2px;
    color:#713f12;
  }

  /* ===== FOOTER ===== */
  .footer{
    position:fixed;
    bottom:5mm;
    left:10mm;
    right:10mm;
    display:flex;
    justify-content:space-between;
    font-size:var(--fs-xs);
    color:var(--muted);
    padding-top:4px;
    border-top:1px solid var(--grid);
  }

  .footer .page:after{
    content: counter(page) " / " counter(pages);
  }

  /* ===== UTILITIES ===== */
  .muted{ color:var(--muted); }
  .bold{ font-weight:600; }
  .small{ font-size:var(--fs-s); }
  .text-success{ color:var(--success); }
  .text-warning{ color:var(--warning); }

  .divider{
    border-top:1px solid var(--grid);
    margin:6px 0;
  }

  /* Test result indicators */
  .result-pass{
    background:#d1fae5;
    color:#065f46;
    padding:1px 4px;
    border-radius:2px;
    font-weight:500;
  }

  .result-fail{
    background:#fee2e2;
    color:#991b1b;
    padding:1px 4px;
    border-radius:2px;
    font-weight:500;
  }
</style>
</head>
<body>

<!-- ========== HEADER ========== -->
<div class="header">
  <div>
    <div class="brand">
      {% if company.logo_url %}
        <img src="{{ company.logo_url }}" alt="{{ company.name }}">
      {% endif %}
      <div class="brand-text">
        <div class="company">{{ company.name | default: "Electrical Contractor" }}</div>
        <div class="contact">
          {{ company.phone }}<br>
          {{ company.email }}
        </div>
      </div>
    </div>
    <div class="title-block">
      <div class="title">MINOR ELECTRICAL INSTALLATION WORKS CERTIFICATE</div>
      <div class="subtitle">
        (Requirements for Electrical Installations - BS 7671)<br>
        To be used only for minor electrical work which does not include the provision of a new circuit
      </div>
    </div>
  </div>
  <div class="cert-box">
    <div class="label">Certificate No.</div>
    <div class="value">{{ certificate_number | default: "MW-0000" }}</div>
  </div>
</div>

<!-- ========== PART 1: DESCRIPTION OF THE MINOR WORKS ========== -->
<div class="section">
  <div class="section-bar">PART 1: Description of the minor works</div>
  <div class="section-content">
    <div class="form-row">
      <div class="col-8 field-group">
        <span class="field-label">1. Details of the Client</span>
        <div class="field-value">{{ client.name }}</div>
      </div>
      <div class="col-4 field-group">
        <span class="field-label">Date minor works completed</span>
        <div class="field-value">{{ work_date }}</div>
      </div>
    </div>

    <div class="form-row">
      <div class="col-12 field-group">
        <span class="field-label">2. Installation location/address</span>
        <div class="field-value">{{ installation.address }}{% if installation.postcode %}, {{ installation.postcode }}{% endif %}</div>
      </div>
    </div>

    <div class="form-row">
      <div class="col-12 field-group">
        <span class="field-label">3. Description of the minor works</span>
        <div class="field-value large">{{ work_description }}</div>
      </div>
    </div>

    <div class="form-row">
      <div class="col-12 field-group">
        <span class="field-label">4. Details of any departures from BS 7671:2018 as amended to {{ bs7671_amendment_date | default: "A2:2022" }} for the circuit altered or extended (Regulation 120.3, 133.1.3 and 133.5)</span>
        <div class="field-value">{{ departures | default: "None" }}</div>
      </div>
    </div>

    <div class="form-row">
      <div class="col-9 field-group">
        <span class="field-label">Details of permitted exceptions (Regulation 411.3.3). Where applicable, a suitable risk assessment(s) must be attached to this Certificate.</span>
        <div class="field-value">{{ permitted_exceptions | default: "None" }}</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">Risk assessment attached</span>
        <div class="field-value" style="display:flex;align-items:center;gap:8px;">
          <span class="cb {% if risk_assessment_attached %}checked{% endif %}">{% if risk_assessment_attached %}✓{% endif %}</span>
          {% if risk_assessment_attached %}Yes{% else %}No{% endif %}
        </div>
      </div>
    </div>

    <div class="form-row">
      <div class="col-12 field-group">
        <span class="field-label">5. Comments on (including any defects observed in) the existing installation (Regulation 644.1.2)</span>
        <div class="field-value large">{{ existing_installation_comments | default: "No defects observed. Existing installation in satisfactory condition." }}</div>
      </div>
    </div>
  </div>
</div>

<!-- ========== PART 2: EARTHING AND BONDING ========== -->
<div class="section">
  <div class="section-bar">PART 2: Presence and adequacy of installation earthing and bonding arrangements (Regulation 132.16)</div>
  <div class="section-content">
    <div class="form-row">
      <div class="col-6">
        <div class="inline-row">
          <span class="inline-label bold">1. System earthing arrangement:</span>
          <span class="cb-item">
            <span class="cb {% if earthing.type == 'TN-S' %}checked{% endif %}">{% if earthing.type == 'TN-S' %}✓{% endif %}</span> TN-S
          </span>
          <span class="cb-item">
            <span class="cb {% if earthing.type == 'TN-C-S' %}checked{% endif %}">{% if earthing.type == 'TN-C-S' %}✓{% endif %}</span> TN-C-S
          </span>
          <span class="cb-item">
            <span class="cb {% if earthing.type == 'TT' %}checked{% endif %}">{% if earthing.type == 'TT' %}✓{% endif %}</span> TT
          </span>
        </div>
      </div>
      <div class="col-6">
        <div class="inline-row">
          <span class="inline-label bold">2. Earth fault loop impedance at distribution board (Z<sub>db</sub>) supplying the final circuit:</span>
          <span class="inline-value">{{ earthing.zdb }}</span> Ω
        </div>
      </div>
    </div>

    <div class="divider"></div>

    <div class="form-row">
      <div class="col-12">
        <div class="inline-label bold" style="margin-bottom:4px;">3. Presence of adequate main protective conductors:</div>
        <div class="inline-row" style="margin-bottom:4px;">
          <span class="cb-item">
            <span class="cb {% if earthing.conductor_present %}checked{% endif %}">{% if earthing.conductor_present %}✓{% endif %}</span> Earthing conductor
          </span>
        </div>
        <div class="inline-row">
          <span class="inline-label">Main protective bonding conductor(s) to:</span>
          <span class="cb-item">
            <span class="cb {% if bonding.water %}checked{% endif %}">{% if bonding.water %}✓{% endif %}</span> Water
          </span>
          <span class="cb-item">
            <span class="cb {% if bonding.gas %}checked{% endif %}">{% if bonding.gas %}✓{% endif %}</span> Gas
          </span>
          <span class="cb-item">
            <span class="cb {% if bonding.oil %}checked{% endif %}">{% if bonding.oil %}✓{% endif %}</span> Oil
          </span>
          <span class="cb-item">
            <span class="cb {% if bonding.structural %}checked{% endif %}">{% if bonding.structural %}✓{% endif %}</span> Structural steel
          </span>
          <span class="cb-item">
            <span class="cb {% if bonding.other %}checked{% endif %}">{% if bonding.other %}✓{% endif %}</span> Other (Specify)
            {% if bonding.other_specify %}<span class="inline-value wider">{{ bonding.other_specify }}</span>{% endif %}
          </span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ========== PART 3: CIRCUIT DETAILS ========== -->
<div class="section">
  <div class="section-bar">PART 3: Circuit details</div>
  <div class="section-content">
    <div class="form-row">
      <div class="col-4 field-group">
        <span class="field-label">DB Reference No.</span>
        <div class="field-value">{{ circuit.db_ref }}</div>
      </div>
      <div class="col-8 field-group">
        <span class="field-label">DB Location and type</span>
        <div class="field-value">{{ circuit.db_location_type }}</div>
      </div>
    </div>

    <div class="form-row">
      <div class="col-2 field-group">
        <span class="field-label">Circuit No.</span>
        <div class="field-value">{{ circuit.number }}</div>
      </div>
      <div class="col-6 field-group">
        <span class="field-label">Circuit description</span>
        <div class="field-value">{{ circuit.description }}</div>
      </div>
      <div class="col-4 field-group">
        <span class="field-label">Installation reference method</span>
        <div class="field-value">{{ circuit.reference_method }}</div>
      </div>
    </div>

    <div class="form-row">
      <div class="col-3 field-group">
        <span class="field-label">Number &amp; size of conductors: Live</span>
        <div class="field-value">{{ circuit.live_size }} mm²</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">cpc</span>
        <div class="field-value">{{ circuit.cpc_size }} mm²</div>
      </div>
      <div class="col-6 field-group">
        <span class="field-label">Cable type</span>
        <div class="field-value">{{ circuit.cable_type }}</div>
      </div>
    </div>

    <div class="divider"></div>

    <div class="form-row">
      <div class="col-3 field-group">
        <span class="field-label">Circuit overcurrent protective device: BS (EN)</span>
        <div class="field-value">{{ circuit.ocpd.bs_en }}</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">Type</span>
        <div class="field-value">{{ circuit.ocpd.type }}</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">Rating</span>
        <div class="field-value">{{ circuit.ocpd.rating }} A</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">Breaking capacity</span>
        <div class="field-value">{{ circuit.ocpd.breaking_capacity }} kA</div>
      </div>
    </div>

    <div class="form-row">
      <div class="col-2 field-group">
        <span class="field-label">RCD: BS (EN)</span>
        <div class="field-value">{{ circuit.rcd.bs_en | default: "—" }}</div>
      </div>
      <div class="col-2 field-group">
        <span class="field-label">Type</span>
        <div class="field-value">{{ circuit.rcd.type | default: "—" }}</div>
      </div>
      <div class="col-2 field-group">
        <span class="field-label">Rating</span>
        <div class="field-value">{{ circuit.rcd.rating | default: "—" }} {% if circuit.rcd.rating %}A{% endif %}</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">Rated residual operating current (I<sub>Δn</sub>)</span>
        <div class="field-value">{{ circuit.rcd.idn | default: "—" }} {% if circuit.rcd.idn %}mA{% endif %}</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">Circuit type</span>
        <div class="field-value">{{ circuit.type | default: "Radial" }}</div>
      </div>
    </div>

    <div class="form-row">
      <div class="col-3 field-group">
        <span class="field-label">AFDD: BS (EN)</span>
        <div class="field-value">{{ circuit.afdd.bs_en | default: "—" }}</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">Rating</span>
        <div class="field-value">{{ circuit.afdd.rating | default: "—" }} {% if circuit.afdd.rating %}A{% endif %}</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">SPD: BS (EN)</span>
        <div class="field-value">{{ circuit.spd.bs_en | default: "—" }}</div>
      </div>
      <div class="col-3 field-group">
        <span class="field-label">Type</span>
        <div class="field-value">{{ circuit.spd.type | default: "—" }}</div>
      </div>
    </div>
  </div>
</div>

<!-- ========== PART 4: TEST RESULTS ========== -->
<div class="section">
  <div class="section-bar">PART 4: Test results for the altered or extended circuit (where relevant and practicable)</div>
  <div class="section-content">
    <table class="tbl">
      <tr>
        <th colspan="4" style="background:var(--shade);">Continuity Tests</th>
        <th colspan="4" style="background:var(--shade);">Insulation Resistance</th>
      </tr>
      <tr>
        <td style="width:12.5%;">
          <div class="small muted">Protective conductor continuity:</div>
        </td>
        <td style="width:12.5%;" class="center">
          <div class="small muted">(R<sub>1</sub>+R<sub>2</sub>)</div>
          <div class="bold">{{ tests.r1_r2 | default: "—" }} Ω</div>
        </td>
        <td style="width:6%;" class="center small muted">or</td>
        <td style="width:12.5%;" class="center">
          <div class="small muted">R<sub>2</sub></div>
          <div class="bold">{{ tests.r2 | default: "—" }} Ω</div>
        </td>
        <td style="width:14%;" class="center">
          <div class="small muted">Test voltage</div>
          <div class="bold">{{ tests.insulation_voltage | default: "500" }} V</div>
        </td>
        <td style="width:14%;" class="center">
          <div class="small muted">Live - Live</div>
          <div class="bold">{{ tests.ir_live_live | default: "—" }} MΩ</div>
        </td>
        <td style="width:14%;" class="center">
          <div class="small muted">Live - Earth</div>
          <div class="bold">{{ tests.ir_live_earth | default: "—" }} MΩ</div>
        </td>
        <td style="width:14%;">
          {% if tests.ir_live_earth >= 1 %}
            <span class="result-pass">PASS</span>
          {% elsif tests.ir_live_earth %}
            <span class="result-fail">FAIL</span>
          {% endif %}
        </td>
      </tr>
      {% if circuit.type == 'Ring' %}
      <tr>
        <td colspan="4">
          <div class="inline-row">
            <span class="small muted">Continuity of ring final circuit conductors:</span>
            <span class="inline-field"><span class="inline-label">L/L</span><span class="inline-value">{{ tests.ring_ll }}</span> Ω</span>
            <span class="inline-field"><span class="inline-label">N/N</span><span class="inline-value">{{ tests.ring_nn }}</span> Ω</span>
            <span class="inline-field"><span class="inline-label">cpc/cpc</span><span class="inline-value">{{ tests.ring_cpc }}</span> Ω</span>
          </div>
        </td>
        <td colspan="4"></td>
      </tr>
      {% endif %}
    </table>

    <table class="tbl" style="margin-top:4px;">
      <tr>
        <th style="width:20%;">Polarity satisfactory</th>
        <th style="width:25%;">Maximum measured earth fault loop impedance: Z<sub>s</sub></th>
        <th style="width:30%;">RCD disconnection time at rated residual operating current (I<sub>Δn</sub>)</th>
        <th style="width:25%;">Satisfactory test button operation</th>
      </tr>
      <tr>
        <td class="center">
          <span class="cb {% if tests.polarity == 'correct' or tests.polarity == 'Correct' %}checked{% endif %}">{% if tests.polarity == 'correct' or tests.polarity == 'Correct' %}✓{% endif %}</span>
          {% if tests.polarity == 'correct' or tests.polarity == 'Correct' %}
            <span class="result-pass">Correct</span>
          {% elsif tests.polarity %}
            <span class="result-fail">Incorrect</span>
          {% endif %}
        </td>
        <td class="center">
          <span class="bold">{{ tests.zs | default: "—" }}</span> Ω
          {% if tests.max_zs %}
            <span class="small muted">(max {{ tests.max_zs }} Ω)</span>
          {% endif %}
        </td>
        <td class="center">
          <span class="bold">{{ tests.rcd_time | default: "—" }}</span> ms
          {% if tests.rcd_time %}
            {% if tests.rcd_time <= 300 %}
              <span class="result-pass">PASS</span>
            {% else %}
              <span class="result-fail">FAIL</span>
            {% endif %}
          {% endif %}
        </td>
        <td class="center">
          <span class="cb {% if tests.rcd_test_button == 'pass' or tests.rcd_test_button == 'Pass' %}checked{% endif %}">{% if tests.rcd_test_button == 'pass' or tests.rcd_test_button == 'Pass' %}✓{% endif %}</span>
          {% if tests.rcd_test_button == 'pass' or tests.rcd_test_button == 'Pass' %}
            <span class="result-pass">Pass</span>
          {% elsif tests.rcd_test_button %}
            <span class="result-fail">Fail</span>
          {% endif %}
        </td>
      </tr>
    </table>

    <table class="tbl" style="margin-top:4px;">
      <tr>
        <td style="width:50%;">
          <div class="inline-row">
            <span class="inline-label">AFDD satisfactory test button operation:</span>
            <span class="cb {% if tests.afdd_test_button == 'pass' or tests.afdd_test_button == 'Pass' %}checked{% endif %}">{% if tests.afdd_test_button == 'pass' or tests.afdd_test_button == 'Pass' %}✓{% endif %}</span>
            <span class="small muted" style="margin-left:8px;">NOTE: Not all AFDDs have a test button</span>
          </div>
        </td>
        <td style="width:50%;">
          <div class="inline-row">
            <span class="inline-label">SPD functionality confirmed:</span>
            <span class="cb {% if tests.spd_ok %}checked{% endif %}">{% if tests.spd_ok %}✓{% endif %}</span>
            <span class="small muted" style="margin-left:8px;">NOTE: Not all SPDs have visible functionality indication</span>
          </div>
        </td>
      </tr>
    </table>

    <!-- Test Equipment -->
    <div class="divider"></div>
    <div class="inline-row" style="margin-top:4px;">
      <span class="inline-field"><span class="inline-label">Test instrument:</span><span class="inline-value wider">{{ test_equipment.model }}</span></span>
      <span class="inline-field"><span class="inline-label">Serial No:</span><span class="inline-value wide">{{ test_equipment.serial }}</span></span>
      <span class="inline-field"><span class="inline-label">Calibration date:</span><span class="inline-value">{{ test_equipment.calibration_date }}</span></span>
    </div>
  </div>
</div>

<!-- ========== PART 5: DECLARATION ========== -->
<div class="section">
  <div class="section-bar">PART 5: Declaration</div>
  <div class="section-content">
    <div class="declaration">
      I certify that the work covered by this certificate does not impair the safety of the existing installation and the work has been designed, constructed, inspected and tested in accordance with <strong>BS 7671:2018 amended to {{ bs7671_amendment_date | default: "A3:2024" }}</strong> and that to the best of my knowledge and belief, at the time of my inspection, complied with BS 7671 except as detailed in Part 1 above.
    </div>

    <div class="signature-area">
      <div>
        <div class="form-row">
          <div class="col-6 field-group">
            <span class="field-label">Name</span>
            <div class="field-value">{{ declaration.name }}</div>
          </div>
          <div class="col-6 field-group">
            <span class="field-label">For and on behalf of</span>
            <div class="field-value">{{ declaration.company }}</div>
          </div>
        </div>
        <div class="form-row">
          <div class="col-12 field-group">
            <span class="field-label">Address</span>
            <div class="field-value">{{ declaration.address }}</div>
          </div>
        </div>
        <div class="form-row">
          <div class="col-4 field-group">
            <span class="field-label">Position</span>
            <div class="field-value">{{ declaration.position }}</div>
          </div>
          <div class="col-4 field-group">
            <span class="field-label">Date</span>
            <div class="field-value">{{ declaration.date }}</div>
          </div>
          <div class="col-4 field-group">
            <span class="field-label">Certificate No.</span>
            <div class="field-value">{{ certificate_number }}</div>
          </div>
        </div>
        <div class="form-row">
          <div class="col-4 field-group">
            <span class="field-label">Scheme Provider</span>
            <div class="field-value">{{ declaration.scheme_provider | default: "—" }}</div>
          </div>
          <div class="col-4 field-group">
            <span class="field-label">Registration Number</span>
            <div class="field-value">{{ declaration.registration_number | default: "—" }}</div>
          </div>
          <div class="col-4 field-group">
            <span class="field-label">Qualification</span>
            <div class="field-value">{{ declaration.qualification | default: "—" }}</div>
          </div>
        </div>
      </div>
      <div>
        <span class="field-label">Signature</span>
        <div class="signature-box">
          {% if declaration.signature %}
            <img src="{{ declaration.signature }}" alt="Signature">
          {% else %}
            <span class="muted small">Digital signature</span>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ========== GUIDANCE ========== -->
<div class="guidance">
  <div class="guidance-title">⚠️ GUIDANCE FOR RECIPIENTS</div>
  <ul>
    <li>This Certificate confirms the minor electrical installation work complies with BS 7671</li>
    <li>You should have received an 'original' Certificate; the contractor retains a duplicate</li>
    <li>If you were the person ordering the work, pass this Certificate to the property owner</li>
    <li>Retain this Certificate with the property deeds and show to future inspectors</li>
    <li>Where RCDs are installed: test six-monthly using the 'T' or 'Test' button</li>
    <li>Where AFDDs are installed: test six-monthly using the test button (if fitted)</li>
    <li>Where SPDs are installed: check status indicator confirms operational condition</li>
  </ul>
</div>

<!-- ========== FOOTER ========== -->
<div class="footer">
  <div>
    <strong>elec-mate</strong> • Minor Works Certificate {{ certificate_number }}<br>
    <span class="small">BS 7671:2018+A3:2024 Compliant • Generated: {{ generated_at }}</span>
  </div>
  <div class="page">Page </div>
</div>

</body>
</html>
