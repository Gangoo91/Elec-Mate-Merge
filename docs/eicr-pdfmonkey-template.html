<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EICR Certificate</title>
    <style>
        @page {
            size: A4;
            margin: 8mm 10mm 12mm 10mm;
        }

        @page schedule {
            size: A4 landscape;
            margin: 6mm;
        }

        .schedule-page {
            page: schedule;
            page-break-before: always;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
            font-size: 8.5px;
            line-height: 1.4;
            color: #1a1a1a;
            background: #fff;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        /* =============================================
           DOCUMENT HEADER
           ============================================= */
        .doc-header {
            background: linear-gradient(180deg, #0a1628 0%, #152238 100%);
            color: #fff;
            padding: 12px 16px;
            margin-bottom: 10px;
            border-radius: 2px;
            position: relative;
            overflow: hidden;
        }

        .doc-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #f59e0b, #fbbf24, #f59e0b);
        }

        .doc-header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .doc-title-section {
            flex: 1;
        }

        .doc-title {
            font-size: 16px;
            font-weight: 700;
            letter-spacing: 0.5px;
            margin-bottom: 2px;
        }

        .doc-subtitle {
            font-size: 7.5px;
            font-weight: 400;
            opacity: 0.85;
            letter-spacing: 0.3px;
        }

        .doc-meta {
            text-align: right;
        }

        .cert-number {
            font-size: 11px;
            font-weight: 700;
            color: #fbbf24;
            letter-spacing: 0.5px;
        }

        .page-number {
            font-size: 8px;
            opacity: 0.7;
            margin-top: 2px;
        }

        .company-logo {
            flex-shrink: 0;
            margin-right: 12px;
        }

        .company-logo img {
            max-height: 45px;
            max-width: 120px;
            object-fit: contain;
        }

        .company-name {
            font-size: 9px;
            font-weight: 600;
            color: #fbbf24;
            margin-top: 4px;
            letter-spacing: 0.3px;
        }

        /* =============================================
           SECTION STYLING
           ============================================= */
        .section {
            margin-bottom: 8px;
        }

        .section-title {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #fff;
            font-size: 9px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            padding: 6px 12px;
            margin-bottom: 6px;
            border-left: 3px solid #f59e0b;
        }

        .section-subtitle {
            background: #f1f5f9;
            color: #334155;
            font-size: 8px;
            font-weight: 600;
            padding: 5px 12px;
            margin-bottom: 4px;
            border-left: 3px solid #64748b;
        }

        /* =============================================
           FORM LAYOUTS
           ============================================= */
        .form-grid {
            display: table;
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 6px;
        }

        .form-row {
            display: table-row;
        }

        .form-label {
            display: table-cell;
            font-size: 7.5px;
            font-weight: 600;
            color: #475569;
            padding: 5px 8px;
            width: 130px;
            vertical-align: middle;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
        }

        .form-value {
            display: table-cell;
            font-size: 8.5px;
            color: #1e293b;
            padding: 5px 8px;
            vertical-align: middle;
            border: 1px solid #e2e8f0;
            background: #fff;
        }

        .form-value input,
        .form-value select {
            border: none;
            background: transparent;
            font-size: 8.5px;
            color: #1e293b;
            width: 100%;
            font-family: inherit;
        }

        /* Inline form layout */
        .inline-form {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
            padding: 6px;
            background: #fafbfc;
            border: 1px solid #e2e8f0;
            border-radius: 2px;
        }

        .inline-group {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .inline-label {
            font-size: 7.5px;
            font-weight: 600;
            color: #64748b;
            white-space: nowrap;
        }

        .inline-value {
            font-size: 8px;
            color: #1e293b;
            padding: 4px 6px;
            background: #fff;
            border: 1px solid #cbd5e1;
            border-radius: 2px;
            min-width: 60px;
            min-height: 22px;
            line-height: 1.4;
        }

        .inline-value.wide {
            min-width: 120px;
            flex: 1;
        }

        /* =============================================
           CHECKBOX STYLING
           ============================================= */
        .checkbox-row {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: center;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 11px;
            height: 11px;
            accent-color: #0f172a;
        }

        .checkbox-item label {
            font-size: 7.5px;
            color: #334155;
        }

        /* =============================================
           TWO COLUMN LAYOUT
           ============================================= */
        .two-col {
            display: flex;
            gap: 8px;
        }

        .two-col > .col {
            flex: 1;
        }

        /* =============================================
           DATA TABLE (Supply/Earthing)
           ============================================= */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 8px;
            margin-bottom: 6px;
        }

        .data-table th {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #fff;
            font-weight: 600;
            font-size: 8px;
            padding: 6px 10px;
            text-align: left;
            border: 1px solid #0f172a;
        }

        .data-table td {
            padding: 8px 10px;
            border: 1px solid #e2e8f0;
            vertical-align: top;
            background: #fff;
        }

        .data-field {
            margin-bottom: 6px;
        }

        .data-field:last-child {
            margin-bottom: 0;
        }

        .data-field-label {
            font-size: 7px;
            font-weight: 600;
            color: #64748b;
            margin-bottom: 2px;
        }

        .data-field-value {
            font-size: 8.5px;
            color: #1e293b;
            padding: 3px 6px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 2px;
        }

        /* =============================================
           DISTRIBUTION BOARD CARDS
           ============================================= */
        .board-card {
            border: 1px solid #cbd5e1;
            border-radius: 3px;
            margin-bottom: 8px;
            overflow: hidden;
        }

        .board-card-header {
            background: linear-gradient(135deg, #334155 0%, #475569 100%);
            color: #fff;
            padding: 6px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .board-card-title {
            font-size: 9px;
            font-weight: 600;
        }

        .board-card-badge {
            font-size: 7px;
            background: rgba(255,255,255,0.2);
            padding: 2px 8px;
            border-radius: 10px;
        }

        .board-card-body {
            padding: 8px;
            background: #fafbfc;
        }

        /* =============================================
           INSPECTION TABLE
           ============================================= */
        .inspection-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 7px;
            margin-bottom: 6px;
        }

        .inspection-table thead th {
            background: #0f172a;
            color: #fff;
            font-weight: 600;
            padding: 5px 4px;
            text-align: center;
            border: 1px solid #0f172a;
            font-size: 6.5px;
        }

        .inspection-table thead th.desc-header {
            text-align: left;
            padding-left: 8px;
        }

        .inspection-table tbody td {
            padding: 4px;
            border: 1px solid #e2e8f0;
            text-align: center;
            font-size: 7px;
        }

        .inspection-table tbody td.item-num {
            width: 35px;
            font-weight: 600;
            color: #475569;
            background: #f8fafc;
        }

        .inspection-table tbody td.item-desc {
            text-align: left;
            padding-left: 6px;
            color: #334155;
        }

        .inspection-table tbody td.outcome {
            width: 28px;
        }

        .inspection-table tbody td.outcome input[type="checkbox"] {
            width: 10px;
            height: 10px;
        }

        .inspection-table tbody td.outcome-text {
            width: 35px;
            font-weight: 600;
        }

        .inspection-table .section-header-row td {
            background: #e2e8f0;
            font-weight: 700;
            color: #1e293b;
            text-align: left;
            padding: 5px 8px;
            font-size: 7.5px;
        }

        .inspection-table tbody tr:nth-child(even) td:not(.item-num) {
            background: #fafbfc;
        }

        /* =============================================
           CIRCUIT TABLE (Landscape Schedule Page)
           ============================================= */
        .circuit-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 8.5px;
        }

        .circuit-table thead tr:first-child th {
            background: #1e293b;
            color: #fff;
            font-size: 8.5px;
            padding: 6px 4px;
            border: 1px solid #0f172a;
        }

        .circuit-table thead tr:nth-child(2) th {
            background: #0f172a;
            color: #fff;
            font-size: 7.5px;
            padding: 5px 3px;
            border: 1px solid #0f172a;
            height: 85px;
            vertical-align: bottom;
        }

        .circuit-table thead .rotate {
            writing-mode: vertical-rl;
            text-orientation: mixed;
            transform: rotate(180deg);
            white-space: nowrap;
            font-size: 7.5px;
        }

        .circuit-table tbody td {
            padding: 5px 4px;
            border: 1px solid #d1d5db;
            text-align: center;
            font-size: 8px;
            background: #fff;
        }

        .circuit-table tbody td.desc {
            text-align: left;
            padding-left: 5px;
            max-width: 100px;
        }

        .circuit-table tbody td.remarks {
            text-align: left;
            padding-left: 5px;
            font-style: italic;
            color: #64748b;
            font-size: 6px;
        }

        .circuit-table tbody tr:nth-child(even) td {
            background: #f8fafc;
        }

        /* Board Info Header for Schedule */
        .board-info-header {
            background: linear-gradient(135deg, #334155 0%, #475569 100%);
            color: #fff;
            padding: 10px 14px;
            margin-bottom: 8px;
            border-radius: 3px;
        }

        .board-info-title {
            font-size: 11px;
            font-weight: 700;
            margin-bottom: 6px;
        }

        .board-info-details {
            display: flex;
            flex-wrap: wrap;
            gap: 16px;
            font-size: 8px;
        }

        .board-info-details span {
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .board-info-verification {
            display: flex;
            gap: 16px;
            margin-top: 6px;
            padding-top: 6px;
            border-top: 1px solid rgba(255,255,255,0.2);
            font-size: 8px;
        }

        /* =============================================
           SIGNATURE BOXES
           ============================================= */
        .signature-grid {
            display: flex;
            gap: 10px;
            margin-top: 8px;
        }

        .signature-box {
            flex: 1;
            border: 1px solid #cbd5e1;
            border-radius: 3px;
            overflow: hidden;
        }

        .signature-box-header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #fff;
            font-size: 8px;
            font-weight: 600;
            padding: 6px 10px;
            border-bottom: 2px solid #f59e0b;
        }

        .signature-box-body {
            padding: 8px;
            background: #fafbfc;
        }

        .sig-field {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            gap: 6px;
        }

        .sig-field:last-child {
            margin-bottom: 0;
        }

        .sig-field-label {
            font-size: 7px;
            font-weight: 600;
            color: #64748b;
            min-width: 65px;
            flex-shrink: 0;
        }

        .sig-field-value {
            flex: 1;
            font-size: 8px;
            color: #1e293b;
            padding: 4px 6px;
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 2px;
            min-height: 22px;
        }

        .sig-field-value.signature {
            min-height: 35px;
            display: flex;
            align-items: center;
        }

        .sig-field-value img {
            max-height: 30px;
        }

        /* =============================================
           OBSERVATIONS
           ============================================= */
        .observations-summary {
            border: 1px solid #e2e8f0;
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .observations-row {
            display: flex;
            border-bottom: 1px solid #e2e8f0;
        }

        .observations-row:last-child {
            border-bottom: none;
        }

        .observations-text {
            flex: 1;
            padding: 5px 8px;
            font-size: 8px;
            color: #334155;
            background: #fff;
        }

        .observations-code {
            width: 60px;
            padding: 5px 8px;
            font-size: 8px;
            font-weight: 700;
            text-align: center;
            background: #f8fafc;
            border-left: 1px solid #e2e8f0;
        }

        .code-c1 { color: #dc2626; }
        .code-c2 { color: #ea580c; }
        .code-c3 { color: #d97706; }
        .code-fi { color: #7c3aed; }

        .codes-legend {
            background: #fffbeb;
            border: 1px solid #fcd34d;
            border-radius: 2px;
            padding: 8px;
            margin-top: 6px;
            font-size: 7px;
            line-height: 1.5;
        }

        .codes-legend strong {
            color: #92400e;
        }

        /* =============================================
           OBSERVATION DETAIL CARDS
           ============================================= */
        .observation-card {
            border: 1px solid #e2e8f0;
            border-radius: 4px;
            margin-bottom: 10px;
            overflow: hidden;
            page-break-inside: avoid;
        }

        .observation-card-header {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            color: #fff;
            padding: 8px 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .observation-card-title {
            font-size: 10px;
            font-weight: 600;
        }

        .observation-card-number {
            font-size: 9px;
            background: rgba(255,255,255,0.15);
            padding: 3px 10px;
            border-radius: 12px;
        }

        .observation-card-body {
            padding: 12px;
            background: #fafbfc;
        }

        .observation-classification {
            margin-bottom: 10px;
        }

        .classification-badge {
            display: inline-block;
            padding: 5px 14px;
            border-radius: 3px;
            font-size: 10px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .classification-badge.c1 {
            background: #fef2f2;
            color: #dc2626;
            border: 2px solid #dc2626;
        }

        .classification-badge.c2 {
            background: #fff7ed;
            color: #ea580c;
            border: 2px solid #ea580c;
        }

        .classification-badge.c3 {
            background: #fffbeb;
            color: #d97706;
            border: 2px solid #d97706;
        }

        .classification-badge.fi {
            background: #f5f3ff;
            color: #7c3aed;
            border: 2px solid #7c3aed;
        }

        .observation-section {
            margin-bottom: 10px;
        }

        .observation-section:last-child {
            margin-bottom: 0;
        }

        .observation-section-title {
            font-size: 8px;
            font-weight: 600;
            color: #475569;
            margin-bottom: 4px;
            padding-bottom: 3px;
            border-bottom: 1px solid #e2e8f0;
        }

        .observation-section-content {
            font-size: 8px;
            color: #334155;
            line-height: 1.5;
            padding: 8px;
            background: #fff;
            border: 1px solid #e2e8f0;
            border-radius: 2px;
        }

        .observation-section-content.recommendation {
            background: #f0fdf4;
            border-color: #86efac;
        }

        .photo-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .photo-item {
            width: calc(33.333% - 4px);
            border: 1px solid #e2e8f0;
            border-radius: 2px;
            overflow: hidden;
            background: #fff;
        }

        .photo-item img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* =============================================
           GUIDANCE SECTION
           ============================================= */
        .guidance-intro {
            font-size: 8px;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 6px;
            padding: 6px 8px;
            background: #f1f5f9;
            border-left: 3px solid #f59e0b;
        }

        .guidance-columns {
            display: flex;
            gap: 12px;
        }

        .guidance-col {
            flex: 1;
            font-size: 6.5px;
            line-height: 1.5;
            color: #475569;
        }

        .guidance-col p {
            margin-bottom: 4px;
            text-align: justify;
        }

        .guidance-col strong {
            color: #1e293b;
        }

        /* =============================================
           DECLARATION BOX
           ============================================= */
        .declaration-box {
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 2px;
            padding: 8px 10px;
            margin-bottom: 6px;
        }

        .declaration-text {
            font-size: 7px;
            color: #475569;
            line-height: 1.6;
            text-align: justify;
        }

        /* =============================================
           OVERALL ASSESSMENT
           ============================================= */
        .assessment-box {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 8px 12px;
            background: #f8fafc;
            border: 1px solid #e2e8f0;
            border-radius: 2px;
        }

        .assessment-label {
            font-size: 8px;
            font-weight: 600;
            color: #475569;
        }

        .assessment-options {
            display: flex;
            gap: 20px;
        }

        .assessment-option {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .assessment-option input[type="checkbox"] {
            width: 14px;
            height: 14px;
        }

        .assessment-option label {
            font-size: 9px;
            font-weight: 700;
        }

        .assessment-option label.satisfactory {
            color: #16a34a;
        }

        .assessment-option label.unsatisfactory {
            color: #dc2626;
        }

        /* Final Assessment Box (after signatures) */
        .final-assessment-box {
            border: 2px solid #1e293b;
            border-radius: 4px;
            padding: 12px 16px;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .final-assessment-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 20px;
        }

        .final-assessment-label {
            font-size: 9px;
            font-weight: 600;
            color: #334155;
        }

        .final-assessment-options {
            display: flex;
            gap: 16px;
        }

        .final-assessment-option {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            border: 2px solid #cbd5e1;
            border-radius: 4px;
            background: #fff;
        }

        .final-assessment-option.selected {
            border-width: 3px;
        }

        .final-assessment-option input[type="checkbox"] {
            width: 16px;
            height: 16px;
        }

        .final-assessment-option .option-label {
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .final-assessment-option .satisfactory-label {
            color: #16a34a;
        }

        .final-assessment-option .unsatisfactory-label {
            color: #dc2626;
        }

        .final-assessment-option.satisfactory-selected {
            background: #16a34a;
            border-color: #16a34a;
        }

        .final-assessment-option.satisfactory-selected .satisfactory-label {
            color: #fff;
        }

        .final-assessment-option.unsatisfactory-selected {
            background: #dc2626;
            border-color: #dc2626;
        }

        .final-assessment-option.unsatisfactory-selected .unsatisfactory-label {
            color: #fff;
        }

        /* =============================================
           PAGE BREAKS
           ============================================= */
        .page-break {
            page-break-before: always;
        }

        .avoid-break {
            page-break-inside: avoid;
        }

        /* =============================================
           UTILITIES
           ============================================= */
        .text-center { text-align: center; }
        .text-left { text-align: left; }
        .text-right { text-align: right; }
        .font-bold { font-weight: 600; }
        .mt-2 { margin-top: 8px; }
        .mb-2 { margin-bottom: 8px; }
        .small { font-size: 7px; }

        /* Special list formatting */
        .intake-list {
            margin: 0;
            padding-left: 12px;
            font-size: 6.5px;
        }

        .intake-list li {
            margin-bottom: 1px;
        }
    </style>
</head>
<body>

<!-- =============================================
     PAGE 1: MAIN CERTIFICATE
     ============================================= -->
<div class="doc-header">
    <div class="doc-header-content">
        {% if company_details.company_logo %}
        <div class="company-logo">
            <img src="{{company_details.company_logo}}" alt="Company Logo" />
        </div>
        {% endif %}
        <div class="doc-title-section">
            <div class="doc-title">ELECTRICAL INSTALLATION CONDITION REPORT</div>
            <div class="doc-subtitle">Condition report for an existing electrical installation in accordance with BS 7671 (IET Wiring Regulations 18th Edition + Amendment 3:2024)</div>
            {% if company_details.company_name %}
            <div class="company-name">{{company_details.company_name}}</div>
            {% endif %}
        </div>
        <div class="doc-meta">
            <div class="cert-number">{{metadata.certificate_number}}</div>
            <div class="page-number">Page 1 of 4</div>
        </div>
    </div>
</div>

<!-- SECTION A: CLIENT DETAILS -->
<div class="section">
    <div class="section-title">Section A: Details of the Client</div>
    <div class="form-grid">
        <div class="form-row">
            <div class="form-label">Client Name</div>
            <div class="form-value"><input type="text" value="{{client_details.client_name}}" /></div>
            <div class="form-label">Telephone</div>
            <div class="form-value"><input type="text" value="{{client_details.client_phone}}" /></div>
        </div>
        <div class="form-row">
            <div class="form-label">Client Address</div>
            <div class="form-value" colspan="3"><input type="text" value="{{client_details.client_address}}" /></div>
        </div>
        <div class="form-row">
            <div class="form-label">Email Address</div>
            <div class="form-value"><input type="text" value="{{client_details.client_email}}" /></div>
            <div class="form-label"></div>
            <div class="form-value"></div>
        </div>
    </div>
</div>

<!-- SECTION B: INSTALLATION ADDRESS -->
<div class="section">
    <div class="section-title">Section B: Details of the Installation</div>
    <div class="form-grid">
        <div class="form-row">
            <div class="form-label">Installation Address</div>
            <div class="form-value" style="width: 100%;"><input type="text" value="{{installation_details.address}}" /></div>
        </div>
    </div>
</div>

<!-- SECTION C: DESCRIPTION OF PREMISES -->
<div class="section">
    <div class="section-title">Section C: Description of Premises</div>
    <div class="inline-form">
        <div class="inline-group">
            <span class="inline-label">Type:</span>
            <div class="checkbox-row">
                <div class="checkbox-item">
                    <input type="checkbox" id="domestic" {% if installation_details.description == "domestic" %} checked {% endif %} />
                    <label for="domestic">Domestic</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="commercial" {% if installation_details.description == "commercial" %} checked {% endif %} />
                    <label for="commercial">Commercial</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="industrial" {% if installation_details.description == "industrial" %} checked {% endif %} />
                    <label for="industrial">Industrial</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="other" {% if installation_details.description == "other" %} checked {% endif %} />
                    <label for="other">Other</label>
                </div>
            </div>
        </div>
        <div class="inline-group">
            <span class="inline-label">Est. Age:</span>
            <span class="inline-value">{{installation_details.estimated_age}} years</span>
        </div>
    </div>
    <div class="inline-form" style="margin-top: 4px;">
        <div class="inline-group">
            <span class="inline-label">Evidence of alterations:</span>
            <div class="checkbox-row">
                <div class="checkbox-item">
                    <input type="checkbox" {% if installation_details.evidence_of_alterations == "yes" %} checked {% endif %} />
                    <label>Yes</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" {% if installation_details.evidence_of_alterations == "no" %} checked {% endif %} />
                    <label>No</label>
                </div>
            </div>
        </div>
        <div class="inline-group" style="flex: 1;">
            <span class="inline-label">Details:</span>
            <span class="inline-value wide">{{installation_details.alterations_details}}</span>
        </div>
    </div>
    <div class="inline-form" style="margin-top: 4px;">
        <div class="inline-group">
            <span class="inline-label">Date of last inspection:</span>
            <div class="checkbox-row">
                <div class="checkbox-item">
                    <input type="checkbox" {% if installation_details.last_inspection_type == "known" %} checked {% endif %} />
                    <label>Known</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" {% if installation_details.last_inspection_type == "unknown" %} checked {% endif %} />
                    <label>Unknown</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" {% if installation_details.last_inspection_type == "not-applicable" %} checked {% endif %} />
                    <label>N/A (First)</label>
                </div>
            </div>
        </div>
        <div class="inline-group">
            <span class="inline-label">Date:</span>
            <span class="inline-value">{{installation_details.date_of_last_inspection}}</span>
        </div>
    </div>
</div>

<!-- SECTION D: EXTENT AND LIMITATIONS -->
<div class="section">
    <div class="section-title">Section D: Extent and Limitations of the Inspection</div>
    <div class="inline-form">
        <div class="inline-group" style="flex: 1;">
            <span class="inline-label">Purpose:</span>
            <span class="inline-value wide">{{installation_details.purpose_of_inspection}}</span>
        </div>
    </div>
    <div class="inline-form" style="margin-top: 4px;">
        <div class="inline-group">
            <span class="inline-label">Date of Inspection:</span>
            <span class="inline-value">{{installation_details.test_date}}</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Recommended Interval:</span>
            <span class="inline-value">{{installation_details.inspection_interval}} years</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Next Inspection Due:</span>
            <span class="inline-value">{{installation_details.next_inspection_date}}</span>
        </div>
    </div>
    <div class="inline-form" style="margin-top: 4px;">
        <div class="inline-group" style="flex: 1;">
            <span class="inline-label">Extent:</span>
            <span class="inline-value wide">{{installation_details.extent_of_inspection}}</span>
        </div>
    </div>
    <div class="inline-form" style="margin-top: 4px;">
        <div class="inline-group" style="flex: 1;">
            <span class="inline-label">Limitations:</span>
            <span class="inline-value wide">{{installation_details.limitations_of_inspection}}</span>
        </div>
    </div>
</div>

<!-- SECTION E: SUMMARY OF CONDITION -->
<div class="section">
    <div class="section-title">Section E: Summary of the Condition of the Installation</div>
    <div class="assessment-box">
        <span class="assessment-label">Overall Assessment:</span>
        <div class="assessment-options">
            <div class="assessment-option">
                <input type="checkbox" id="satisfactory" {% if declarations.satisfactory_for_continued_use %} checked {% endif %} />
                <label for="satisfactory" class="satisfactory">SATISFACTORY</label>
            </div>
            <div class="assessment-option">
                <input type="checkbox" id="unsatisfactory" {% unless declarations.satisfactory_for_continued_use %} checked {% endunless %} />
                <label for="unsatisfactory" class="unsatisfactory">UNSATISFACTORY</label>
            </div>
        </div>
    </div>
</div>

<!-- DECLARATION -->
<div class="section">
    <div class="declaration-box">
        <div class="declaration-text">
            I/We, being the person(s) responsible for the inspection and testing of the electrical installation (as indicated by my/our signatures below), particulars of which are described above, having exercised reasonable skill and care when carrying out the inspection and testing, hereby declare that the information in this report, including the observations and the attached schedules, provides an accurate assessment of the condition of the electrical installation taking into account the stated extent and limitations.
        </div>
    </div>
</div>

<!-- SECTION F: SUPPLY CHARACTERISTICS -->
<div class="section">
    <div class="section-title">Section F: Supply Characteristics and Earthing Arrangements</div>
    <table class="data-table">
        <thead>
            <tr>
                <th style="width: 50%;">Earthing Arrangements</th>
                <th style="width: 50%;">Supply Parameters</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <div class="data-field">
                        <div class="data-field-label">System Type</div>
                        <div class="checkbox-row" style="margin-top: 4px;">
                            <div class="checkbox-item">
                                <input type="checkbox" {% if supply_characteristics.earthing_arrangement == "TN-C" %} checked {% endif %} />
                                <label>TN-C</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" {% if supply_characteristics.earthing_arrangement == "TN-S" %} checked {% endif %} />
                                <label>TN-S</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" {% if supply_characteristics.earthing_arrangement == "TN-C-S" %} checked {% endif %} />
                                <label>TN-C-S</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" {% if supply_characteristics.earthing_arrangement == "TT" %} checked {% endif %} />
                                <label>TT</label>
                            </div>
                        </div>
                    </div>
                    <div class="data-field">
                        <div class="data-field-label">Supply PME</div>
                        <div class="data-field-value">{{supply_characteristics.supply_pme}}</div>
                    </div>
                    <div class="data-field">
                        <div class="data-field-label">Earth Electrode Type</div>
                        <div class="data-field-value">{{earthing_bonding.earth_electrode_type}}</div>
                    </div>
                    <div class="data-field">
                        <div class="data-field-label">DNO (Distribution Network Operator)</div>
                        <div class="data-field-value">{{supply_characteristics.dno_name}}</div>
                    </div>
                </td>
                <td>
                    <div class="data-field">
                        <div class="data-field-label">Nominal Voltage (U&#8320;)</div>
                        <div class="data-field-value">{{supply_characteristics.supply_voltage}} V</div>
                    </div>
                    <div class="data-field">
                        <div class="data-field-label">Nominal Frequency</div>
                        <div class="data-field-value">{{supply_characteristics.supply_frequency}} Hz</div>
                    </div>
                    <div class="data-field">
                        <div class="data-field-label">Number of Phases</div>
                        <div class="data-field-value">{{supply_characteristics.phases}}</div>
                    </div>
                    <div class="data-field">
                        <div class="data-field-label">Main Protective Device</div>
                        <div class="data-field-value">{{main_protective_device.device_type}}</div>
                    </div>
                    <div class="data-field">
                        <div class="data-field-label">Main Switch Rating</div>
                        <div class="data-field-value">{{main_protective_device.main_switch_rating}} A</div>
                    </div>
                    <div class="data-field">
                        <div class="data-field-label">Breaking Capacity</div>
                        <div class="data-field-value">{{main_protective_device.breaking_capacity}} kA</div>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>

<!-- SECTION G: BONDING -->
<div class="section">
    <div class="section-title">Section G: Main Protective Bonding Conductors</div>
    <div class="inline-form">
        <div class="inline-group">
            <span class="inline-label">Main Bonding Size (mm&#178;):</span>
            <span class="inline-value">{{earthing_bonding.main_bonding_size}}</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Compliance:</span>
            <span class="inline-value">{{earthing_bonding.bonding_compliance}}</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Supplementary Bonding (mm&#178;):</span>
            <span class="inline-value">{{earthing_bonding.supplementary_bonding_size}}</span>
        </div>
    </div>
    <div class="inline-form" style="margin-top: 4px;">
        <div class="inline-group" style="flex: 1;">
            <span class="inline-label">Main Bonding Locations:</span>
            <span class="inline-value wide">{{earthing_bonding.main_bonding_locations}}</span>
        </div>
    </div>
</div>

<!-- SECTION H: DISTRIBUTION BOARDS -->
<div class="section">
    <div class="section-title">Section H: Consumer Unit / Distribution Board Details</div>

    <!-- Main Board -->
    <div class="board-card">
        <div class="board-card-header">
            <span class="board-card-title">{{distribution_board.board_designation | default: "Main Distribution Board"}}</span>
            <span class="board-card-badge">DB1</span>
        </div>
        <div class="board-card-body">
            <div class="inline-form" style="border: none; padding: 0; background: transparent;">
                <div class="inline-group">
                    <span class="inline-label">Location:</span>
                    <span class="inline-value">{{distribution_board.board_location}}</span>
                </div>
                <div class="inline-group">
                    <span class="inline-label">Manufacturer:</span>
                    <span class="inline-value">{{distribution_board.board_manufacturer}}</span>
                </div>
                <div class="inline-group">
                    <span class="inline-label">Type:</span>
                    <span class="inline-value">{{distribution_board.board_type}}</span>
                </div>
                <div class="inline-group">
                    <span class="inline-label">Ways:</span>
                    <span class="inline-value">{{distribution_board.board_ways}}</span>
                </div>
            </div>
            <div class="inline-form" style="border: none; padding: 0; background: transparent; margin-top: 4px;">
                <div class="inline-group">
                    <span class="inline-label">Zdb (&#937;):</span>
                    <span class="inline-value">{{distribution_board_verification.zdb}}</span>
                </div>
                <div class="inline-group">
                    <span class="inline-label">Ipf (kA):</span>
                    <span class="inline-value">{{distribution_board_verification.ipf}}</span>
                </div>
                <div class="inline-group">
                    <div class="checkbox-item">
                        <input type="checkbox" {% if distribution_board_verification.confirmed_correct_polarity %} checked {% endif %} />
                        <label>Polarity Confirmed</label>
                    </div>
                </div>
                <div class="inline-group">
                    <div class="checkbox-item">
                        <input type="checkbox" {% if distribution_board_verification.spd_operational_status %} checked {% endif %} />
                        <label>SPD Operational</label>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Additional Boards -->
    {% for board in additional_boards %}
    <div class="board-card">
        <div class="board-card-header">
            <span class="board-card-title">{{board.designation}}</span>
            <span class="board-card-badge">DB{{forloop.index | plus: 1}}</span>
        </div>
        <div class="board-card-body">
            <div class="inline-form" style="border: none; padding: 0; background: transparent;">
                <div class="inline-group">
                    <span class="inline-label">Location:</span>
                    <span class="inline-value">{{board.location}}</span>
                </div>
                <div class="inline-group">
                    <span class="inline-label">Manufacturer:</span>
                    <span class="inline-value">{{board.manufacturer}}</span>
                </div>
                <div class="inline-group">
                    <span class="inline-label">Type:</span>
                    <span class="inline-value">{{board.board_type}}</span>
                </div>
                <div class="inline-group">
                    <span class="inline-label">Ways:</span>
                    <span class="inline-value">{{board.ways}}</span>
                </div>
            </div>
            <div class="inline-form" style="border: none; padding: 0; background: transparent; margin-top: 4px;">
                <div class="inline-group">
                    <span class="inline-label">Zdb (&#937;):</span>
                    <span class="inline-value">{{board.zdb}}</span>
                </div>
                <div class="inline-group">
                    <span class="inline-label">Ipf (kA):</span>
                    <span class="inline-value">{{board.ipf}}</span>
                </div>
            </div>
        </div>
    </div>
    {% endfor %}

    <!-- Cables -->
    <div class="section-subtitle">Meter & Cable Details</div>
    <div class="inline-form">
        <div class="inline-group">
            <span class="inline-label">Meter Tails Size:</span>
            <span class="inline-value">{{cables.tails_size}}</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Tails Length (m):</span>
            <span class="inline-value">{{cables.tails_length}}</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Main Earth Conductor:</span>
            <span class="inline-value">{{earthing_bonding.main_earthing_conductor}}</span>
        </div>
    </div>
</div>

<!-- SECTION K: OBSERVATIONS SUMMARY -->
{% if observations.size > 0 %}
<div class="section">
    <div class="section-title">Section K: Observations</div>
    <div class="observations-summary">
        <div class="observations-row" style="background: #f1f5f9; font-weight: 600;">
            <div class="observations-text">Observation Description</div>
            <div class="observations-code">Code</div>
        </div>
        {% for observation in observations %}
        <div class="observations-row">
            <div class="observations-text">{{observation.description}}</div>
            <div class="observations-code {% if observation.defect_code == 'C1' %}code-c1{% elsif observation.defect_code == 'C2' %}code-c2{% elsif observation.defect_code == 'C3' %}code-c3{% else %}code-fi{% endif %}">
                {{observation.defect_code}}
            </div>
        </div>
        {% endfor %}
    </div>
    <div class="codes-legend">
        <strong>Classification Codes:</strong><br/>
        <strong>C1</strong> - Danger present. Risk of injury. Immediate remedial action required.<br/>
        <strong>C2</strong> - Potentially dangerous. Urgent remedial action required.<br/>
        <strong>C3</strong> - Improvement recommended.<br/>
        <strong>FI</strong> - Further investigation required without delay.
    </div>
</div>
{% endif %}


<!-- =============================================
     PAGE 2: SCHEDULE OF INSPECTION
     ============================================= -->
<div class="page-break"></div>

<div class="doc-header">
    <div class="doc-header-content">
        <div class="doc-title-section">
            <div class="doc-title">SCHEDULE OF INSPECTION</div>
            <div class="doc-subtitle">Inspection checklist in accordance with BS 7671</div>
        </div>
        <div class="doc-meta">
            <div class="cert-number">{{metadata.certificate_number}}</div>
            <div class="page-number">Page 2 of 4</div>
        </div>
    </div>
</div>

<!-- Inspection Checklist -->
<div class="section">
    <table class="inspection-table">
        <thead>
            <tr>
                <th style="width: 35px;">Item</th>
                <th class="desc-header" style="width: auto;">Description</th>
                <th style="width: 28px;">&#10003;</th>
                <th style="width: 28px;">N/A</th>
                <th style="width: 35px;">C1/C2</th>
                <th style="width: 28px;">C3</th>
                <th style="width: 28px;">N/V</th>
                <th style="width: 28px;">LIM</th>
            </tr>
        </thead>
        <tbody>
            {% for section in inspection_items %}
            {% assign section_index = forloop.index %}
            <tr class="section-header-row">
                <td colspan="8">{{section_index}}.0 &nbsp; {{section.section_name}}</td>
            </tr>
            {% for item in section.items %}
            <tr>
                <td class="item-num">{{section_index}}.{{forloop.index}}</td>
                <td class="item-desc">
                    {% if section_index == 1 and forloop.index == 1 %}
                    <ul class="intake-list">
                        <li>Service cable</li>
                        <li>Service head</li>
                        <li>Earthing arrangement</li>
                        <li>Meter tails</li>
                        <li>Metering equipment</li>
                        <li>Isolator (where present)</li>
                    </ul>
                    {% else %}
                    {{item.item}}
                    {% endif %}
                </td>
                <td class="outcome">{% if item.outcome == "satisfactory" %}✓{% endif %}</td>
                <td class="outcome">{% if item.outcome == "not-applicable" %}✓{% endif %}</td>
                <td class="outcome-text">{% if item.outcome == 'C1' or item.outcome == 'C2' %}{{item.outcome}}{% endif %}</td>
                <td class="outcome">{% if item.outcome == "C3" %}✓{% endif %}</td>
                <td class="outcome">{% if item.outcome == "not-verified" %}✓{% endif %}</td>
                <td class="outcome">{% if item.outcome == "limitation" %}✓{% endif %}</td>
            </tr>
            {% endfor %}
            {% endfor %}
        </tbody>
    </table>
</div>


<!-- =============================================
     PAGE 3: SCHEDULE OF TEST RESULTS (LANDSCAPE)
     ============================================= -->
<div class="schedule-page">

<div class="doc-header">
    <div class="doc-header-content">
        <div class="doc-title-section">
            <div class="doc-title">SCHEDULE OF CIRCUIT DETAILS AND TEST RESULTS</div>
            <div class="doc-subtitle">{{distribution_board.board_designation | default: "Main Distribution Board"}} - {{distribution_board.board_location}}</div>
        </div>
        <div class="doc-meta">
            <div class="cert-number">{{metadata.certificate_number}}</div>
            <div class="page-number">Page 3 of 4</div>
        </div>
    </div>
</div>

<!-- Test Instrument Details -->
<div class="section" style="margin-bottom: 6px;">
    <div class="section-title" style="font-size: 9px; padding: 4px 6px;">Test Instrument Details</div>
    <div class="inline-form" style="font-size: 8px;">
        <div class="inline-group">
            <span class="inline-label">Instrument Make/Model:</span>
            <span class="inline-value wide">{{test_instrument_details.make_model}}</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Serial No:</span>
            <span class="inline-value">{{test_instrument_details.serial_number}}</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Calibration Date:</span>
            <span class="inline-value">{{test_instrument_details.calibration_date}}</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Test Temperature:</span>
            <span class="inline-value">{{test_instrument_details.test_temperature}}°C</span>
        </div>
    </div>
</div>

<!-- Distribution Board Info Header -->
<div class="board-info-header">
    <div class="board-title">{{distribution_board.board_designation | default: "Main Distribution Board"}}</div>
    <div class="board-details">
        <span><strong>Location:</strong> {{distribution_board.board_location}}</span>
        <span><strong>Manufacturer:</strong> {{distribution_board.board_manufacturer}}</span>
        <span><strong>Type:</strong> {{distribution_board.board_type}}</span>
        <span><strong>Ways:</strong> {{distribution_board.board_ways}}</span>
    </div>
    <div class="board-verification">
        <span><strong>Zdb:</strong> {{distribution_board_verification.zdb | default: "-"}} Ω</span>
        <span><strong>Ipf:</strong> {{distribution_board_verification.ipf | default: "-"}} kA</span>
        <span>Polarity: {% if distribution_board_verification.confirmed_correct_polarity %}✓{% else %}○{% endif %}</span>
        <span>SPD: {% if distribution_board_verification.spd_operational_status %}✓{% else %}○{% endif %}</span>
    </div>
</div>

<table class="circuit-table">
    <thead>
        <tr>
            <th colspan="4">Circuit Details</th>
            <th colspan="5">Conductor</th>
            <th colspan="5">Overcurrent Device</th>
            <th colspan="4">RCD</th>
            <th colspan="5">Continuity (&#937;)</th>
            <th colspan="3">Insulation (M&#937;)</th>
            <th></th>
            <th>Zs</th>
            <th colspan="2">RCD Test</th>
            <th>AFDD</th>
            <th rowspan="2" style="width: 50px;">Remarks</th>
        </tr>
        <tr>
            <th style="width: 22px;"><span class="rotate">Cct</span></th>
            <th colspan="3" style="width: 70px;">Description</th>
            <th><span class="rotate">Wiring</span></th>
            <th><span class="rotate">Ref</span></th>
            <th><span class="rotate">Points</span></th>
            <th><span class="rotate">Live mm&#178;</span></th>
            <th><span class="rotate">CPC mm&#178;</span></th>
            <th><span class="rotate">BS(EN)</span></th>
            <th><span class="rotate">Type</span></th>
            <th><span class="rotate">Rating A</span></th>
            <th><span class="rotate">kA</span></th>
            <th><span class="rotate">Max Zs</span></th>
            <th><span class="rotate">BS(EN)</span></th>
            <th><span class="rotate">Type</span></th>
            <th><span class="rotate">I&#916;n mA</span></th>
            <th><span class="rotate">Rating A</span></th>
            <th><span class="rotate">r1 &#937;</span></th>
            <th><span class="rotate">rn &#937;</span></th>
            <th><span class="rotate">r2 &#937;</span></th>
            <th><span class="rotate">R1+R2</span></th>
            <th><span class="rotate">R2</span></th>
            <th><span class="rotate">Test V</span></th>
            <th><span class="rotate">L-L</span></th>
            <th><span class="rotate">L-E</span></th>
            <th><span class="rotate">Pol</span></th>
            <th><span class="rotate">Meas &#937;</span></th>
            <th><span class="rotate">ms</span></th>
            <th><span class="rotate">Test Btn</span></th>
            <th><span class="rotate">AFDD</span></th>
        </tr>
    </thead>
    <tbody>
        {% for circuit in schedule_of_tests %}
        <tr>
            <td>{{circuit.circuit_number}}</td>
            <td colspan="3" class="desc">{{circuit.circuit_description}}</td>
            <td>{{circuit.type_of_wiring}}</td>
            <td>{{circuit.reference_method}}</td>
            <td>{{circuit.points_served}}</td>
            <td>{{circuit.live_size}}</td>
            <td>{{circuit.cpc_size}}</td>
            <td>{{circuit.bs_standard}}</td>
            <td>{{circuit.protective_device_curve}}</td>
            <td>{{circuit.protective_device_rating}}</td>
            <td>{{circuit.protective_device_ka_rating}}</td>
            <td>{{circuit.max_zs}}</td>
            <td>{{circuit.rcd_bs_standard}}</td>
            <td>{{circuit.rcd_type | default: "-"}}</td>
            <td>{{circuit.rcd_rating}}</td>
            <td>{{circuit.rcd_rating_a}}</td>
            <td>{{circuit.ring_r1}}</td>
            <td>{{circuit.ring_rn}}</td>
            <td>{{circuit.ring_r2}}</td>
            <td>{{circuit.r1r2}}</td>
            <td>{{circuit.r2}}</td>
            <td>{{circuit.insulation_test_voltage}}</td>
            <td>{{circuit.insulation_live_neutral}}</td>
            <td>{{circuit.insulation_live_earth}}</td>
            <td>{{circuit.polarity}}</td>
            <td>{{circuit.zs}}</td>
            <td>{{circuit.rcd_one_x}}</td>
            <td>{{circuit.rcd_test_button}}</td>
            <td>{{circuit.afdd_test}}</td>
            <td class="remarks">{{circuit.notes}}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

</div><!-- End schedule-page -->


<!-- =============================================
     PAGE 4: DECLARATIONS & SIGNATURES
     ============================================= -->
<div class="page-break"></div>

<div class="doc-header">
    <div class="doc-header-content">
        <div class="doc-title-section">
            <div class="doc-title">DECLARATIONS AND SIGNATURES</div>
            <div class="doc-subtitle">Completion and certification details</div>
        </div>
        <div class="doc-meta">
            <div class="cert-number">{{metadata.certificate_number}}</div>
            <div class="page-number">Page 4 of 4</div>
        </div>
    </div>
</div>

<!-- Inspector Details -->
<div class="section">
    <div class="section-title">Inspector Declaration</div>
    <div class="declaration-box">
        <div class="declaration-text">
            I/We, being the person(s) responsible for the inspection and testing of the electrical installation (as indicated by my/our signatures below), particulars of which are described above, having exercised reasonable skill and care when carrying out the inspection and testing, hereby declare that the information in this report, including the observations and the attached schedules, provides an accurate assessment of the condition of the electrical installation taking into account the stated extent and limitations in Section D of this report.
        </div>
    </div>
    <div class="inline-form" style="margin-top: 6px;">
        <div class="inline-group" style="flex: 1;">
            <span class="inline-label">Inspector Name:</span>
            <span class="inline-value wide">{{inspector.name}}</span>
        </div>
        <div class="inline-group" style="flex: 1;">
            <span class="inline-label">Qualifications:</span>
            <span class="inline-value wide">{{inspector.qualifications}}</span>
        </div>
    </div>
    <div class="inline-form" style="margin-top: 4px;">
        <div class="inline-group" style="flex: 1;">
            <span class="inline-label">Company:</span>
            <span class="inline-value wide">{{inspector.company}}</span>
        </div>
        <div class="inline-group">
            <span class="inline-label">Date:</span>
            <span class="inline-value">{{inspector.date}}</span>
        </div>
    </div>
    {% if declarations.additional_notes %}
    <div class="inline-form" style="margin-top: 4px;">
        <div class="inline-group" style="flex: 1;">
            <span class="inline-label">Additional Comments:</span>
            <span class="inline-value wide" style="min-height: 30px;">{{declarations.additional_notes}}</span>
        </div>
    </div>
    {% endif %}
</div>

<!-- Signatures -->
<div class="signature-grid">
    <div class="signature-box">
        <div class="signature-box-header">Inspected and Tested By</div>
        <div class="signature-box-body">
            <div class="sig-field">
                <span class="sig-field-label">Name (CAPITALS)</span>
                <span class="sig-field-value">{{declarations.inspected_by.name}}</span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">Signature</span>
                <span class="sig-field-value signature">
                    {% if declarations.inspected_by.signature contains "data:" %}
                    <img src="{{declarations.inspected_by.signature}}" />
                    {% endif %}
                </span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">For/on behalf of</span>
                <span class="sig-field-value">{{declarations.inspected_by.for_on_behalf_of}}</span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">Position</span>
                <span class="sig-field-value">{{declarations.inspected_by.position}}</span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">Address</span>
                <span class="sig-field-value">{{declarations.inspected_by.address}}</span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">CP Scheme</span>
                <span class="sig-field-value" style="max-width: 80px;">{{declarations.inspected_by.cp_scheme}}</span>
                <span style="font-size: 7px; margin-left: 8px;">
                    <input type="checkbox" {% if declarations.inspected_by.cp_scheme_na %} checked {% endif %} /> N/A
                </span>
            </div>
        </div>
    </div>
    <div class="signature-box">
        <div class="signature-box-header">Report Authorised for Issue By</div>
        <div class="signature-box-body">
            <div class="sig-field">
                <span class="sig-field-label">Name (CAPITALS)</span>
                <span class="sig-field-value">{{declarations.report_authorised_by.name}}</span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">Date</span>
                <span class="sig-field-value" style="max-width: 100px;">{{declarations.report_authorised_by.date}}</span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">Signature</span>
                <span class="sig-field-value signature">
                    {% if declarations.report_authorised_by.signature contains "data:" %}
                    <img src="{{declarations.report_authorised_by.signature}}" />
                    {% endif %}
                </span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">For/on behalf of</span>
                <span class="sig-field-value">{{declarations.report_authorised_by.for_on_behalf_of}}</span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">Position</span>
                <span class="sig-field-value">{{declarations.report_authorised_by.position}}</span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">Address</span>
                <span class="sig-field-value">{{declarations.report_authorised_by.address}}</span>
            </div>
            <div class="sig-field">
                <span class="sig-field-label">Membership No</span>
                <span class="sig-field-value">{{declarations.report_authorised_by.membership_no}}</span>
            </div>
        </div>
    </div>
</div>

<!-- Final Overall Assessment -->
<div class="section" style="margin-top: 12px;">
    <div class="section-title">Overall Assessment of the Installation</div>
    <div class="final-assessment-box">
        <div class="final-assessment-content">
            <span class="final-assessment-label">The overall condition of the electrical installation is assessed as:</span>
            <div class="final-assessment-options">
                <div class="final-assessment-option {% if declarations.satisfactory_for_continued_use %}satisfactory-selected{% endif %}">
                    <input type="checkbox" {% if declarations.satisfactory_for_continued_use %} checked {% endif %} />
                    <span class="option-label satisfactory-label">SATISFACTORY</span>
                </div>
                <div class="final-assessment-option {% unless declarations.satisfactory_for_continued_use %}unsatisfactory-selected{% endunless %}">
                    <input type="checkbox" {% unless declarations.satisfactory_for_continued_use %} checked {% endunless %} />
                    <span class="option-label unsatisfactory-label">UNSATISFACTORY</span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Guidance for Recipients -->
<div class="section" style="margin-top: 12px;">
    <div class="section-title">Guidance for Recipients</div>
    <div class="guidance-intro">This Report is an important and valuable document which should be retained for future reference.</div>
    <div class="guidance-columns">
        <div class="guidance-col">
            <p><strong>1.</strong> The purpose of this Report is to confirm, as far as reasonably practicable, whether or not the electrical installation is in a satisfactory condition for continued service. The Report should identify any damage, deterioration, defects and/or conditions which may give rise to danger.</p>
            <p><strong>2.</strong> This Report is only valid if accompanied by the Inspection Schedule(s) and the Schedule(s) of Circuit Details and Test Results.</p>
            <p><strong>3.</strong> The person ordering the Report should have received the 'original' Report and the inspector should have retained a duplicate.</p>
            <p><strong>4.</strong> The 'original' Report should be retained in a safe place and be made available to any person inspecting or undertaking work on the electrical installation in the future.</p>
            <p><strong>5.</strong> Section D (Extent and Limitations) should identify fully the extent of the installation covered by this Report and any limitations on the inspection and testing.</p>
            <p><strong>6.</strong> Some operational limitations such as inability to gain access to parts of the installation may have been encountered during the inspection.</p>
            <p><strong>7.</strong> For items classified as <strong>C1</strong> ('Danger present') the safety of those using the installation is at risk - immediate remedial action required.</p>
        </div>
        <div class="guidance-col">
            <p><strong>8.</strong> For items classified as <strong>C2</strong> ('Potentially dangerous') the safety of those using the installation may be at risk - urgent remedial action is required.</p>
            <p><strong>9.</strong> Where <strong>FI</strong> (Further Investigation) is stated, the inspection has revealed an apparent deficiency which could not be fully identified due to the extent or limitations.</p>
            <p><strong>10.</strong> For safety reasons, the electrical installation should be re-inspected at appropriate intervals by a skilled person. The recommended date is stated in Section D.</p>
            <p><strong>11.</strong> Where the installation includes an RCD it should be tested six-monthly by pressing the button marked 'T' or 'Test'.</p>
            <p><strong>12.</strong> Where the installation includes an AFDD having a manual test facility it should be tested six-monthly.</p>
            <p><strong>13.</strong> Where the installation includes an SPD the status indicator should be checked to confirm operational condition.</p>
            <p><strong>14.</strong> Where the installation includes alternative sources of supply, warning notices should be found at the origin or meter position.</p>
        </div>
    </div>
</div>


<!-- =============================================
     APPENDIX: OBSERVATION DETAILS (IF ANY)
     ============================================= -->
{% if observations.size > 0 %}
<div class="page-break"></div>

<div class="doc-header">
    <div class="doc-header-content">
        <div class="doc-title-section">
            <div class="doc-title">OBSERVATION DETAILS</div>
            <div class="doc-subtitle">Detailed descriptions with photographic evidence and recommendations</div>
        </div>
        <div class="doc-meta">
            <div class="cert-number">{{metadata.certificate_number}}</div>
            <div class="page-number">Appendix</div>
        </div>
    </div>
</div>

{% for observation in observations %}
<div class="observation-card avoid-break">
    <div class="observation-card-header">
        <span class="observation-card-title">Observation Item</span>
        <span class="observation-card-number">#{{forloop.index}}</span>
    </div>
    <div class="observation-card-body">
        <div class="observation-classification">
            {% if observation.defect_code == "C1" %}
            <span class="classification-badge c1">C1 - DANGER PRESENT</span>
            {% elsif observation.defect_code == "C2" %}
            <span class="classification-badge c2">C2 - POTENTIALLY DANGEROUS</span>
            {% elsif observation.defect_code == "C3" %}
            <span class="classification-badge c3">C3 - IMPROVEMENT RECOMMENDED</span>
            {% elsif observation.defect_code == "FI" %}
            <span class="classification-badge fi">FI - FURTHER INVESTIGATION</span>
            {% else %}
            <span class="classification-badge">{{observation.defect_code}}</span>
            {% endif %}
        </div>

        <div class="observation-section">
            <div class="observation-section-title">Location / Item Reference</div>
            <div class="observation-section-content">{{observation.item}}</div>
        </div>

        {% if observation.photo_evidence.size > 0 %}
        <div class="observation-section">
            <div class="observation-section-title">Photographic Evidence</div>
            <div class="photo-grid">
                {% for img in observation.photo_evidence %}
                <div class="photo-item">
                    <img src="{{img}}" />
                </div>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <div class="observation-section">
            <div class="observation-section-title">Description</div>
            <div class="observation-section-content">{{observation.description}}</div>
        </div>

        <div class="observation-section">
            <div class="observation-section-title">Recommendation</div>
            <div class="observation-section-content recommendation">{{observation.recommendation}}</div>
        </div>
    </div>
</div>
{% endfor %}
{% endif %}

</body>
</html>
