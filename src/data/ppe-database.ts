/**
 * Comprehensive PPE Database for UK Electrical Work
 * All standards are current BS EN standards as of 2024
 */

export interface PPEDefinition {
  id: string;
  category: string;
  name: string;
  standard: string;
  standardName: string;
  purpose: string;
  mandatory: boolean;
  applicableFor: string[]; // Types of work this applies to
  variants?: string[];
}

export const PPE_CATEGORIES = [
  { id: 'head', name: 'Head Protection', icon: 'HardHat' },
  { id: 'eye', name: 'Eye & Face Protection', icon: 'Eye' },
  { id: 'hearing', name: 'Hearing Protection', icon: 'Ear' },
  { id: 'respiratory', name: 'Respiratory Protection', icon: 'Wind' },
  { id: 'hand', name: 'Hand Protection', icon: 'Hand' },
  { id: 'body', name: 'Body Protection', icon: 'Shield' },
  { id: 'foot', name: 'Foot Protection', icon: 'Footprints' },
  { id: 'fall', name: 'Fall Protection', icon: 'ArrowDown' },
  { id: 'electrical', name: 'Electrical Protection', icon: 'Zap' },
  { id: 'visibility', name: 'High Visibility', icon: 'Sun' },
] as const;

export const PPE_DATABASE: PPEDefinition[] = [
  // HEAD PROTECTION
  {
    id: 'industrial-helmet',
    category: 'head',
    name: 'Industrial Safety Helmet',
    standard: 'BS EN 397',
    standardName: 'Industrial safety helmets',
    purpose: 'Protection against falling objects and head impact',
    mandatory: true,
    applicableFor: ['construction', 'industrial', 'general'],
  },
  {
    id: 'bump-cap',
    category: 'head',
    name: 'Bump Cap',
    standard: 'BS EN 812',
    standardName: 'Industrial bump caps',
    purpose: 'Protection against bumping head on stationary objects',
    mandatory: false,
    applicableFor: ['confined-spaces', 'ceiling-work'],
  },
  {
    id: 'insulating-helmet',
    category: 'head',
    name: 'Electrically Insulating Helmet',
    standard: 'BS EN 50365',
    standardName: 'Electrically insulating helmets for use on low voltage installations',
    purpose: 'Head protection with electrical insulation for LV work',
    mandatory: true,
    applicableFor: ['electrical', 'live-working'],
  },
  {
    id: 'arc-flash-hood',
    category: 'head',
    name: 'Arc Flash Hood/Balaclava',
    standard: 'BS EN 61482-1-2',
    standardName: 'Protective clothing against thermal hazards of an electric arc',
    purpose: 'Full head and neck protection against arc flash',
    mandatory: true,
    applicableFor: ['arc-flash', 'hv-switching'],
    variants: ['8 cal/cm²', '12 cal/cm²', '25 cal/cm²', '40 cal/cm²'],
  },

  // EYE & FACE PROTECTION
  {
    id: 'safety-spectacles',
    category: 'eye',
    name: 'Safety Spectacles',
    standard: 'BS EN 166',
    standardName: 'Personal eye protection - Specifications',
    purpose: 'General eye protection against mechanical hazards',
    mandatory: true,
    applicableFor: ['general', 'drilling', 'cutting'],
  },
  {
    id: 'safety-goggles',
    category: 'eye',
    name: 'Safety Goggles',
    standard: 'BS EN 166',
    standardName: 'Personal eye protection - Specifications',
    purpose: 'Enclosed eye protection against dust, liquids and gases',
    mandatory: true,
    applicableFor: ['dusty', 'chemical', 'grinding'],
  },
  {
    id: 'face-shield',
    category: 'eye',
    name: 'Face Shield',
    standard: 'BS EN 166',
    standardName: 'Personal eye protection - Specifications',
    purpose: 'Full face protection against splashes and particles',
    mandatory: false,
    applicableFor: ['grinding', 'chemical', 'cutting'],
  },
  {
    id: 'arc-face-shield',
    category: 'eye',
    name: 'Arc Flash Face Shield',
    standard: 'BS EN 61482-1-2 / GS-ET-29',
    standardName: 'Arc flash tested face shield',
    purpose: 'Face protection against electric arc flash hazards',
    mandatory: true,
    applicableFor: ['arc-flash', 'hv-switching', 'live-working'],
    variants: ['8 cal/cm²', '12 cal/cm²', '25 cal/cm²', '40 cal/cm²'],
  },
  {
    id: 'welding-filter',
    category: 'eye',
    name: 'Welding Filter/Shield',
    standard: 'BS EN 169 / BS EN 175',
    standardName: 'Filters for welding and related techniques',
    purpose: 'Protection against optical radiation from welding',
    mandatory: true,
    applicableFor: ['welding', 'brazing'],
  },

  // HEARING PROTECTION
  {
    id: 'ear-plugs',
    category: 'hearing',
    name: 'Ear Plugs',
    standard: 'BS EN 352-2',
    standardName: 'Hearing protectors - Ear plugs',
    purpose: 'Hearing protection in noisy environments',
    mandatory: true,
    applicableFor: ['noisy', 'drilling', 'grinding', 'chasing'],
  },
  {
    id: 'ear-muffs',
    category: 'hearing',
    name: 'Ear Defenders/Muffs',
    standard: 'BS EN 352-1',
    standardName: 'Hearing protectors - Ear muffs',
    purpose: 'Hearing protection with higher attenuation',
    mandatory: true,
    applicableFor: ['noisy', 'power-tools', 'chasing'],
  },
  {
    id: 'helmet-mounted-defenders',
    category: 'hearing',
    name: 'Helmet-Mounted Ear Defenders',
    standard: 'BS EN 352-3',
    standardName: 'Hearing protectors - Ear muffs attached to safety helmets',
    purpose: 'Combined head and hearing protection',
    mandatory: false,
    applicableFor: ['construction', 'industrial'],
  },

  // RESPIRATORY PROTECTION
  {
    id: 'ffp2-mask',
    category: 'respiratory',
    name: 'FFP2 Filtering Face Piece',
    standard: 'BS EN 149',
    standardName: 'Respiratory protective devices - Filtering half masks',
    purpose: 'Protection against fine dust and particles',
    mandatory: true,
    applicableFor: ['dusty', 'insulation', 'chasing'],
  },
  {
    id: 'ffp3-mask',
    category: 'respiratory',
    name: 'FFP3 Filtering Face Piece',
    standard: 'BS EN 149',
    standardName: 'Respiratory protective devices - Filtering half masks',
    purpose: 'High protection against fine/toxic particles',
    mandatory: true,
    applicableFor: ['asbestos-adjacent', 'silica', 'hazardous-dust'],
  },
  {
    id: 'half-mask-respirator',
    category: 'respiratory',
    name: 'Half Mask Respirator',
    standard: 'BS EN 140',
    standardName: 'Respiratory protective devices - Half masks and quarter masks',
    purpose: 'Reusable respiratory protection with replaceable filters',
    mandatory: false,
    applicableFor: ['painting', 'chemical', 'prolonged-dusty'],
  },
  {
    id: 'powered-respirator',
    category: 'respiratory',
    name: 'Powered Air Purifying Respirator (PAPR)',
    standard: 'BS EN 12941',
    standardName: 'Powered filtering devices incorporating helmet or hood',
    purpose: 'Powered respiratory protection for extended use',
    mandatory: false,
    applicableFor: ['confined-spaces', 'extended-exposure'],
  },

  // HAND PROTECTION
  {
    id: 'general-work-gloves',
    category: 'hand',
    name: 'General Purpose Work Gloves',
    standard: 'BS EN 388',
    standardName: 'Protective gloves against mechanical risks',
    purpose: 'Protection against cuts, abrasion and puncture',
    mandatory: true,
    applicableFor: ['general', 'handling', 'cable-pulling'],
  },
  {
    id: 'cut-resistant-gloves',
    category: 'hand',
    name: 'Cut Resistant Gloves',
    standard: 'BS EN 388 (Cut Level D/E)',
    standardName: 'Protective gloves - Cut resistance level D or E',
    purpose: 'High cut protection for handling sharp materials',
    mandatory: true,
    applicableFor: ['cable-work', 'sharp-materials', 'metalwork'],
  },
  {
    id: 'insulating-gloves-class0',
    category: 'hand',
    name: 'Electrical Insulating Gloves (Class 0)',
    standard: 'BS EN 60903',
    standardName: 'Live working - Gloves of insulating material',
    purpose: 'Electrical insulation up to 1000V AC / 1500V DC',
    mandatory: true,
    applicableFor: ['electrical', 'live-working', 'lv-work'],
    variants: ['Class 00 (500V)', 'Class 0 (1000V)'],
  },
  {
    id: 'insulating-gloves-class1',
    category: 'hand',
    name: 'Electrical Insulating Gloves (Class 1)',
    standard: 'BS EN 60903',
    standardName: 'Live working - Gloves of insulating material',
    purpose: 'Electrical insulation up to 7500V AC',
    mandatory: true,
    applicableFor: ['hv-work', 'live-working'],
    variants: ['Class 1 (7500V)', 'Class 2 (17000V)', 'Class 3 (26500V)', 'Class 4 (36000V)'],
  },
  {
    id: 'arc-flash-gloves',
    category: 'hand',
    name: 'Arc Flash Gloves',
    standard: 'BS EN 61482-1-2',
    standardName: 'Protective clothing against thermal hazards of an electric arc',
    purpose: 'Protection against arc flash thermal hazards',
    mandatory: true,
    applicableFor: ['arc-flash', 'hv-switching'],
  },
  {
    id: 'chemical-gloves',
    category: 'hand',
    name: 'Chemical Resistant Gloves',
    standard: 'BS EN 374',
    standardName: 'Protective gloves against dangerous chemicals and micro-organisms',
    purpose: 'Protection against chemicals and solvents',
    mandatory: true,
    applicableFor: ['chemical', 'battery-work', 'cleaning'],
  },
  {
    id: 'leather-protector-gloves',
    category: 'hand',
    name: 'Leather Protector Gloves',
    standard: 'BS EN 388',
    standardName: 'Over-gloves for use with insulating gloves',
    purpose: 'Mechanical protection over insulating gloves',
    mandatory: true,
    applicableFor: ['live-working', 'electrical'],
  },

  // BODY PROTECTION
  {
    id: 'coveralls',
    category: 'body',
    name: 'Work Coveralls',
    standard: 'BS EN ISO 13688',
    standardName: 'Protective clothing - General requirements',
    purpose: 'General body protection and identification',
    mandatory: false,
    applicableFor: ['general', 'industrial'],
  },
  {
    id: 'arc-flash-coverall',
    category: 'body',
    name: 'Arc Flash Coverall/Suit',
    standard: 'BS EN 61482-1-2',
    standardName: 'Protective clothing against thermal hazards of an electric arc',
    purpose: 'Full body protection against arc flash',
    mandatory: true,
    applicableFor: ['arc-flash', 'hv-switching', 'live-working'],
    variants: ['Class 1 (4 kA)', 'Class 2 (7 kA)', '8 cal/cm²', '12 cal/cm²', '25 cal/cm²', '40 cal/cm²'],
  },
  {
    id: 'arc-flash-jacket-trousers',
    category: 'body',
    name: 'Arc Flash Jacket & Trousers',
    standard: 'BS EN 61482-1-2',
    standardName: 'Protective clothing against thermal hazards of an electric arc',
    purpose: 'Arc flash protection with flexibility',
    mandatory: true,
    applicableFor: ['arc-flash', 'hv-switching'],
    variants: ['Class 1 (4 kA)', 'Class 2 (7 kA)'],
  },
  {
    id: 'flame-retardant-clothing',
    category: 'body',
    name: 'Flame Retardant Clothing',
    standard: 'BS EN ISO 11612',
    standardName: 'Protective clothing against heat and flame',
    purpose: 'Protection against heat and flame',
    mandatory: true,
    applicableFor: ['hot-work', 'welding', 'electrical'],
  },
  {
    id: 'chainsaw-trousers',
    category: 'body',
    name: 'Chainsaw Protection Trousers',
    standard: 'BS EN 381-5',
    standardName: 'Protective clothing for chainsaw users - Leg protectors',
    purpose: 'Leg protection when using chainsaws',
    mandatory: true,
    applicableFor: ['chainsaw', 'tree-work'],
  },

  // FOOT PROTECTION
  {
    id: 'safety-boots-s3',
    category: 'foot',
    name: 'Safety Boots (S3)',
    standard: 'BS EN ISO 20345 S3',
    standardName: 'Personal protective equipment - Safety footwear',
    purpose: 'Toe protection, puncture resistance, water resistant',
    mandatory: true,
    applicableFor: ['construction', 'industrial', 'general'],
  },
  {
    id: 'safety-boots-s1p',
    category: 'foot',
    name: 'Safety Boots (S1P)',
    standard: 'BS EN ISO 20345 S1P',
    standardName: 'Personal protective equipment - Safety footwear',
    purpose: 'Toe and puncture protection for indoor work',
    mandatory: true,
    applicableFor: ['indoor', 'commercial', 'domestic'],
  },
  {
    id: 'esd-safety-boots',
    category: 'foot',
    name: 'ESD Safety Boots',
    standard: 'BS EN ISO 20345 + BS EN 61340-5-1',
    standardName: 'Safety footwear with electrostatic dissipative properties',
    purpose: 'Static dissipation for sensitive electronics work',
    mandatory: true,
    applicableFor: ['electronics', 'data-centres', 'cleanroom'],
  },
  {
    id: 'electrical-hazard-boots',
    category: 'foot',
    name: 'Electrical Hazard (EH) Boots',
    standard: 'BS EN ISO 20345 + ASTM F2413 EH',
    standardName: 'Safety footwear with electrical hazard protection',
    purpose: 'Secondary protection against electrical shock',
    mandatory: true,
    applicableFor: ['electrical', 'live-working'],
  },
  {
    id: 'insulating-boots',
    category: 'foot',
    name: 'Electrically Insulating Boots',
    standard: 'BS EN 50321-1',
    standardName: 'Live working - Footwear - Insulating footwear',
    purpose: 'Primary electrical insulation for live working',
    mandatory: true,
    applicableFor: ['live-working', 'hv-work'],
  },
  {
    id: 'wellington-safety',
    category: 'foot',
    name: 'Safety Wellington Boots',
    standard: 'BS EN ISO 20345 S5',
    standardName: 'Safety footwear - Waterproof with toe and midsole protection',
    purpose: 'Waterproof safety footwear for wet conditions',
    mandatory: true,
    applicableFor: ['wet-conditions', 'outdoor', 'trenching'],
  },

  // FALL PROTECTION
  {
    id: 'safety-harness',
    category: 'fall',
    name: 'Full Body Safety Harness',
    standard: 'BS EN 361',
    standardName: 'Personal fall protection equipment - Full body harnesses',
    purpose: 'Fall arrest and work positioning',
    mandatory: true,
    applicableFor: ['height-work', 'roof-work', 'towers'],
  },
  {
    id: 'fall-arrest-lanyard',
    category: 'fall',
    name: 'Fall Arrest Lanyard',
    standard: 'BS EN 354 / BS EN 355',
    standardName: 'Personal fall protection - Lanyards and energy absorbers',
    purpose: 'Connection between harness and anchor with shock absorption',
    mandatory: true,
    applicableFor: ['height-work', 'roof-work'],
  },
  {
    id: 'retractable-fall-arrester',
    category: 'fall',
    name: 'Retractable Fall Arrester',
    standard: 'BS EN 360',
    standardName: 'Personal fall protection - Retractable type fall arresters',
    purpose: 'Self-retracting lifeline for fall arrest',
    mandatory: false,
    applicableFor: ['height-work', 'vertical-access'],
  },
  {
    id: 'work-positioning-belt',
    category: 'fall',
    name: 'Work Positioning Belt',
    standard: 'BS EN 358',
    standardName: 'Personal protective equipment for work positioning',
    purpose: 'Hands-free work positioning (not for fall arrest)',
    mandatory: false,
    applicableFor: ['pole-work', 'tower-work'],
  },

  // HIGH VISIBILITY
  {
    id: 'hi-vis-vest-class2',
    category: 'visibility',
    name: 'Hi-Vis Vest (Class 2)',
    standard: 'BS EN ISO 20471 Class 2',
    standardName: 'High visibility clothing',
    purpose: 'Enhanced visibility in daytime conditions',
    mandatory: true,
    applicableFor: ['roadside', 'construction', 'outdoor'],
  },
  {
    id: 'hi-vis-jacket-class3',
    category: 'visibility',
    name: 'Hi-Vis Jacket (Class 3)',
    standard: 'BS EN ISO 20471 Class 3',
    standardName: 'High visibility clothing - Highest visibility class',
    purpose: 'Maximum visibility for high-risk environments',
    mandatory: true,
    applicableFor: ['highways', 'railways', 'night-work'],
  },
  {
    id: 'hi-vis-trousers',
    category: 'visibility',
    name: 'Hi-Vis Trousers',
    standard: 'BS EN ISO 20471 Class 1/2',
    standardName: 'High visibility clothing - Leg coverage',
    purpose: 'Lower body visibility',
    mandatory: false,
    applicableFor: ['highways', 'railways'],
  },

  // ELECTRICAL SPECIFIC
  {
    id: 'insulating-matting',
    category: 'electrical',
    name: 'Electrical Insulating Matting',
    standard: 'BS EN 61111',
    standardName: 'Live working - Electrical insulating matting',
    purpose: 'Floor insulation for switchgear areas',
    mandatory: true,
    applicableFor: ['switchrooms', 'substations', 'lv-panels'],
  },
  {
    id: 'insulating-blanket',
    category: 'electrical',
    name: 'Insulating Blanket',
    standard: 'BS EN 61112',
    standardName: 'Live working - Electrical insulating blankets',
    purpose: 'Insulating cover for live conductors',
    mandatory: true,
    applicableFor: ['live-working', 'hv-work'],
  },
  {
    id: 'voltage-detector',
    category: 'electrical',
    name: 'Voltage Detector/Indicator',
    standard: 'BS EN 61243-3 / GS 38',
    standardName: 'Live working - Voltage detectors',
    purpose: 'Verification of dead/live status',
    mandatory: true,
    applicableFor: ['electrical', 'isolation'],
  },
  {
    id: 'lock-off-kit',
    category: 'electrical',
    name: 'Lock Off Kit (LOTO)',
    standard: 'BS 7671 / HSG85',
    standardName: 'Lock Out Tag Out equipment',
    purpose: 'Safe isolation of electrical supplies',
    mandatory: true,
    applicableFor: ['electrical', 'isolation', 'maintenance'],
  },
];

// Helper function to get PPE by category
export const getPPEByCategory = (categoryId: string): PPEDefinition[] => {
  return PPE_DATABASE.filter(ppe => ppe.category === categoryId);
};

// Helper function to get recommended PPE for work type
export const getRecommendedPPE = (workTypes: string[]): PPEDefinition[] => {
  return PPE_DATABASE.filter(ppe =>
    ppe.applicableFor.some(applicable => workTypes.includes(applicable))
  );
};

// Common electrical work PPE presets
export const PPE_PRESETS = {
  'domestic-electrical': [
    'industrial-helmet',
    'safety-spectacles',
    'general-work-gloves',
    'safety-boots-s1p',
    'voltage-detector',
  ],
  'commercial-electrical': [
    'industrial-helmet',
    'safety-spectacles',
    'ear-plugs',
    'general-work-gloves',
    'safety-boots-s3',
    'hi-vis-vest-class2',
    'voltage-detector',
    'lock-off-kit',
  ],
  'industrial-electrical': [
    'industrial-helmet',
    'safety-spectacles',
    'ear-muffs',
    'ffp2-mask',
    'general-work-gloves',
    'flame-retardant-clothing',
    'safety-boots-s3',
    'hi-vis-jacket-class3',
    'voltage-detector',
    'lock-off-kit',
  ],
  'live-lv-working': [
    'insulating-helmet',
    'arc-face-shield',
    'insulating-gloves-class0',
    'leather-protector-gloves',
    'arc-flash-coverall',
    'electrical-hazard-boots',
    'insulating-matting',
    'voltage-detector',
  ],
  'hv-switching': [
    'arc-flash-hood',
    'arc-face-shield',
    'insulating-gloves-class1',
    'leather-protector-gloves',
    'arc-flash-coverall',
    'insulating-boots',
    'insulating-blanket',
    'voltage-detector',
    'lock-off-kit',
  ],
  'construction-site': [
    'industrial-helmet',
    'safety-spectacles',
    'ear-plugs',
    'ffp2-mask',
    'general-work-gloves',
    'safety-boots-s3',
    'hi-vis-vest-class2',
  ],
  'height-work': [
    'industrial-helmet',
    'safety-spectacles',
    'general-work-gloves',
    'safety-boots-s3',
    'safety-harness',
    'fall-arrest-lanyard',
  ],
} as const;

export type PPEPresetKey = keyof typeof PPE_PRESETS;
