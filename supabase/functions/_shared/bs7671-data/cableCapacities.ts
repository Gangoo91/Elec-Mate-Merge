export type CableType = 'pvc-twin-earth' | 'xlpe-twin-earth' | 'pvc-single' | 'xlpe-single' | 'swa';

export interface CableCapacity {
  size: number;
  capacities: {
    [method: string]: number; // Reference method -> current rating in amps
  };
}

// BS 7671 Appendix 4 Table 4D5 - Current-carrying capacity
export function getCableCapacity(type: CableType, size: number): CableCapacity | null {
  const capacityData: Record<CableType, Record<number, any>> = {
    'pvc-twin-earth': {
      1.0: { A1: 13.5, A2: 13.5, B1: 15.5, B2: 14.5, C: 17.5 },
      1.5: { A1: 17.5, A2: 17.5, B1: 19.5, B2: 18, C: 22 },
      2.5: { A1: 24, A2: 24, B1: 27, B2: 25, C: 30 },
      4: { A1: 32, A2: 31, B1: 36, B2: 34, C: 40 },
      6: { A1: 41, A2: 39, B1: 46, B2: 43, C: 51 },
      10: { A1: 57, A2: 54, B1: 63, B2: 60, C: 70 },
      16: { A1: 76, A2: 73, B1: 85, B2: 80, C: 94 },
      25: { A1: 101, A2: 96, B1: 112, B2: 107, C: 119 },
      35: { A1: 125, A2: 119, B1: 138, B2: 133, C: 148 },
      50: { A1: 151, A2: 144, B1: 168, B2: 161, C: 180 }
    },
    'xlpe-twin-earth': {
      1.0: { A1: 15, A2: 15, B1: 17, B2: 16, C: 19 },
      1.5: { A1: 19, A2: 19, B1: 21, B2: 20, C: 24 },
      2.5: { A1: 27, A2: 26, B1: 29, B2: 28, C: 33 },
      4: { A1: 36, A2: 35, B1: 39, B2: 37, C: 45 },
      6: { A1: 46, A2: 44, B1: 50, B2: 48, C: 58 },
      10: { A1: 63, A2: 60, B1: 69, B2: 66, C: 79 },
      16: { A1: 85, A2: 81, B1: 93, B2: 89, C: 107 },
      25: { A1: 112, A2: 108, B1: 123, B2: 118, C: 138 },
      35: { A1: 138, A2: 133, B1: 151, B2: 146, C: 171 },
      50: { A1: 168, A2: 161, B1: 184, B2: 177, C: 209 }
    },
    'pvc-single': {
      1.0: { C: 15, D1: 14, D2: 13, E: 17, F: 14, G: 13 },
      1.5: { C: 19.5, D1: 17.5, D2: 16.5, E: 22, F: 18, G: 16.5 },
      2.5: { C: 27, D1: 24, D2: 23, E: 30, F: 25, G: 23 },
      4: { C: 36, D1: 32, D2: 30, E: 40, F: 34, G: 31 },
      6: { C: 46, D1: 41, D2: 38, E: 51, F: 43, G: 39 },
      10: { C: 63, D1: 57, D2: 52, E: 70, F: 60, G: 54 },
      16: { C: 85, D1: 76, D2: 69, E: 94, F: 80, G: 73 },
      25: { C: 112, D1: 101, D2: 90, E: 119, F: 101, G: 92 },
      35: { C: 138, D1: 125, D2: 111, E: 148, F: 125, G: 113 },
      50: { C: 168, D1: 151, D2: 134, E: 180, F: 151, G: 137 },
      70: { C: 213, D1: 192, D2: 171, E: 232, F: 192, G: 173 },
      95: { C: 258, D1: 232, D2: 207, E: 282, F: 232, G: 210 },
      120: { C: 299, D1: 269, D2: 239, E: 328, F: 269, G: 243 },
      150: { C: 344, D1: 309, D2: 275, E: 379, F: 309, G: 280 },
      185: { C: 392, D1: 353, D2: 314, E: 434, F: 353, G: 319 },
      240: { C: 461, D1: 415, D2: 370, E: 514, F: 415, G: 376 },
      300: { C: 530, D1: 477, D2: 424, E: 593, F: 477, G: 432 }
    },
    'xlpe-single': {
      1.0: { C: 17, D1: 15, D2: 14, E: 19, F: 15, G: 14 },
      1.5: { C: 21, D1: 19, D2: 18, E: 24, F: 19, G: 18 },
      2.5: { C: 29, D1: 26, D2: 25, E: 33, F: 27, G: 25 },
      4: { C: 39, D1: 35, D2: 33, E: 45, F: 37, G: 34 },
      6: { C: 50, D1: 45, D2: 42, E: 58, F: 47, G: 43 },
      10: { C: 69, D1: 62, D2: 57, E: 79, F: 65, G: 59 },
      16: { C: 93, D1: 84, D2: 76, E: 107, F: 87, G: 79 },
      25: { C: 123, D1: 111, D2: 99, E: 138, F: 112, G: 101 },
      35: { C: 151, D1: 137, D2: 122, E: 171, F: 138, G: 124 },
      50: { C: 184, D1: 167, D2: 147, E: 209, F: 168, G: 150 },
      70: { C: 234, D1: 213, D2: 188, E: 269, F: 213, G: 190 },
      95: { C: 284, D1: 258, D2: 228, E: 328, F: 258, G: 230 },
      120: { C: 329, D1: 299, D2: 264, E: 382, F: 299, G: 267 },
      150: { C: 379, D1: 344, D2: 304, E: 441, F: 344, G: 307 },
      185: { C: 434, D1: 392, D2: 347, E: 506, F: 392, G: 350 },
      240: { C: 514, D1: 464, D2: 410, E: 599, F: 464, G: 413 },
      300: { C: 593, D1: 535, D2: 473, E: 692, F: 535, G: 476 }
    },
    'swa': {
      1.5: { C: 21, D1: 19, D2: 18, E: 24, F: 19, G: 18 },
      2.5: { C: 29, D1: 26, D2: 25, E: 33, F: 27, G: 25 },
      4: { C: 39, D1: 35, D2: 33, E: 45, F: 37, G: 34 },
      6: { C: 50, D1: 45, D2: 42, E: 58, F: 47, G: 43 },
      10: { C: 69, D1: 62, D2: 57, E: 79, F: 65, G: 59 },
      16: { C: 93, D1: 84, D2: 76, E: 107, F: 87, G: 79 },
      25: { C: 123, D1: 111, D2: 99, E: 138, F: 112, G: 101 },
      35: { C: 151, D1: 137, D2: 122, E: 171, F: 138, G: 124 },
      50: { C: 184, D1: 167, D2: 147, E: 209, F: 168, G: 150 },
      70: { C: 234, D1: 213, D2: 188, E: 269, F: 213, G: 190 },
      95: { C: 284, D1: 258, D2: 228, E: 328, F: 258, G: 230 },
      120: { C: 329, D1: 299, D2: 264, E: 382, F: 299, G: 267 },
      150: { C: 379, D1: 344, D2: 304, E: 441, F: 344, G: 307 },
      185: { C: 434, D1: 392, D2: 347, E: 506, F: 392, G: 350 },
      240: { C: 514, D1: 464, D2: 410, E: 599, F: 464, G: 413 },
      300: { C: 593, D1: 535, D2: 473, E: 692, F: 535, G: 476 }
    }
  };

  const data = capacityData[type]?.[size];
  if (!data) return null;

  return {
    size,
    capacities: data
  };
}
